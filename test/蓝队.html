<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left: 0.25em solid rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


/* Flowchart variables */
/* Sequence Diagram variables */
/* Gantt chart variables */
.mermaid .label {
  color: #323D47;
}

g.label {
    color: #333;
}

.node rect,
.node circle,
.node ellipse,
.node polygon {
  fill: #BDD5EA;
  stroke: #81B1DB;
  stroke-width: 1px;
}
.edgePath .path {
  stroke: lightgrey;
}
.edgeLabel {
  background-color: #e8e8e8;
}
.cluster rect {
  fill: #6D6D65 !important;
  rx: 4 !important;
  stroke: rgba(255, 255, 255, 0.25) !important;
  stroke-width: 1px !important;
}
.cluster text {
  fill: #F9FFFE;
}
.actor {
  stroke: #81B1DB;
  fill: #BDD5EA;
}
text.actor {
  fill: black;
  stroke: none;
}
.actor-line {
  stroke: lightgrey;
}
.messageLine0 {
  stroke-width: 1.5;
  stroke-dasharray: "2 2";
  marker-end: "url(file:///C://Users//lenovo//AppData//Roaming//Typora/themes/night/#arrowhead)";
  stroke: lightgrey;
}
.messageLine1 {
  stroke-width: 1.5;
  stroke-dasharray: "2 2";
  stroke: lightgrey;
}
#arrowhead {
  fill: lightgrey !important;
}
#crosshead path {
  fill: lightgrey !important;
  stroke: lightgrey !important;
}
.messageText {
  fill: lightgrey;
  stroke: none;
}
.labelBox {
  stroke: #81B1DB;
  fill: #BDD5EA;
}
.labelText {
  fill: #323D47;
  stroke: none;
}
.loopText {
  fill: lightgrey;
  stroke: none;
}
text>tspan {
  fill: inherit;
}
.loopLine {
  stroke-width: 2;
  stroke-dasharray: "2 2";
  marker-end: "url(file:///C://Users//lenovo//AppData//Roaming//Typora/themes/night/#arrowhead)";
  stroke: #81B1DB;
}
.note {
  stroke: rgba(255, 255, 255, 0.25);
  fill: #fff5ad;
}
.noteText {
  fill: black;
  stroke: none;
  font-family: 'trebuchet ms', verdana, arial;
  font-size: 14px;
}
/** Section styling */
.section {
  stroke: none;
  opacity: 0.2;
}
.section0 {
  fill: rgba(255, 255, 255, 0.3);
}
.section2 {
  fill: #EAE8B9;
}
.section1,
.section3 {
  fill: white;
  opacity: 0.2;
}
.sectionTitle0 {
  fill: #F9FFFE;
}
.sectionTitle1 {
  fill: #F9FFFE;
}
.sectionTitle2 {
  fill: #F9FFFE;
}
.sectionTitle3 {
  fill: #F9FFFE;
}
.sectionTitle {
  text-anchor: start;
  font-size: 11px;
  text-height: 14px;
}
/* Grid and axis */
.grid .tick {
  stroke: rgba(255, 255, 255, 0.3);
  opacity: 0.3;
  shape-rendering: crispEdges;
}
.grid .tick text {
  fill: lightgrey;
  opacity: 0.5;
}
.grid path {
  stroke-width: 0;
}
/* Today line */
.today {
  fill: none;
  stroke: #DB5757;
  stroke-width: 2px;
}
/* Task styling */
/* Default task */
.task {
  stroke-width: 1;
}
.taskText {
  text-anchor: middle;
  font-size: 11px;
}
.taskTextOutsideRight {
  fill: #323D47;
  text-anchor: start;
  font-size: 11px;
}
.taskTextOutsideLeft {
  fill: #323D47;
  text-anchor: end;
  font-size: 11px;
}
/* Specific task settings for the sections*/
.taskText0,
.taskText1,
.taskText2,
.taskText3 {
  fill: #323D47;
}
.task0,
.task1,
.task2,
.task3 {
  fill: #BDD5EA;
  stroke: rgba(255, 255, 255, 0.5);
}
.taskTextOutside0,
.taskTextOutside2 {
  fill: lightgrey;
}
.taskTextOutside1,
.taskTextOutside3 {
  fill: lightgrey;
}
/* Active task */
.active0,
.active1,
.active2,
.active3 {
  fill: #81B1DB;
  stroke: rgba(255, 255, 255, 0.5);
}
.activeText0,
.activeText1,
.activeText2,
.activeText3 {
  fill: #323D47 !important;
}
/* Completed task */
.done0,
.done1,
.done2,
.done3 {
  fill: lightgrey;
}
.doneText0,
.doneText1,
.doneText2,
.doneText3 {
  fill: #323D47 !important;
}
/* Tasks on the critical line */
.crit0,
.crit1,
.crit2,
.crit3 {
  stroke: #E83737;
  fill: #E83737;
  stroke-width: 2;
}
.activeCrit0,
.activeCrit1,
.activeCrit2,
.activeCrit3 {
  stroke: #E83737;
  fill: #81B1DB;
  stroke-width: 2;
}
.doneCrit0,
.doneCrit1,
.doneCrit2,
.doneCrit3 {
  stroke: #E83737;
  fill: lightgrey;
  stroke-width: 1;
  cursor: pointer;
  shape-rendering: crispEdges;
}
.doneCritText0,
.doneCritText1,
.doneCritText2,
.doneCritText3 {
  fill: lightgrey !important;
}
.activeCritText0,
.activeCritText1,
.activeCritText2,
.activeCritText3 {
  fill: #323D47 !important;
}
.titleText {
  text-anchor: middle;
  font-size: 18px;
  fill: lightgrey;
}
/*


*/
.node text {
  font-family: 'trebuchet ms', verdana, arial;
  font-size: 14px;
}
div.mermaidTooltip {
  position: absolute;
  text-align: center;
  max-width: 200px;
  padding: 2px;
  font-family: 'trebuchet ms', verdana, arial;
  font-size: 12px;
  background: #6D6D65;
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 2px;
  pointer-events: none;
  z-index: 100;
}


/* CSS Document */

/** code highlight */

.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable {
    color: #b8bfc6;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

.CodeMirror-gutters {
    border-right: none;
}

/* CSS Document */

/** markdown source **/
.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property
{
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
	color: #8aa1e1;
}@import "";
@import "";
@import "";

:root {
    --bg-color:  #363B40;
    --side-bar-bg-color: #2E3033;
    --text-color: #b8bfc6;

    --select-text-bg-color:#4a89dc;

    --item-hover-bg-color: #0a0d16;
    --control-text-color: #b7b7b7;
    --control-text-hover-color: #eee;
    --window-border: 1px solid #555;

    --active-file-bg-color: rgb(34, 34, 34);
    --active-file-border-color: #8d8df0;

    --primary-color: #a3d5fe;

    --active-file-text-color: white;
    --item-hover-bg-color: #70717d;
    --item-hover-text-color: white;
    --primary-color: #6dc1e7;

    --rawblock-edit-panel-bd: #4B535A;
}

html {
    font-size: 16px;
}

html,
body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    background: #363B40;
    background: var(--bg-color);
    fill: currentColor;
}

#write {
    max-width: 914px;
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
    color: #b8bfc6;
    border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after {
    background: #4B535A;
}

.popover.bottom > .arrow:after {
    border-bottom-color: #4B535A;
}

html,
body,
button,
input,
select,
textarea {
    font-style: normal;
    line-height: 1.625rem;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

hr {
    height: 2px;
    border: 0;
    margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: "Lucida Grande", "Corbel", sans-serif;
    font-weight: normal;
    clear: both;
    -ms-word-wrap: break-word;
    word-wrap: break-word;
    margin: 0;
    padding: 0;
    color: #DEDEDE
}

h1 {
    font-size: 2.5rem;
    /* 36px */
    line-height: 2.75rem;
    /* 40px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1.5px;
}

h2 {
    font-size: 1.63rem;
    /* 24px */
    line-height: 1.875rem;
    /* 30px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h3 {
    font-size: 1.17rem;
    /* 18px */
    line-height: 1.5rem;
    /* 24px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h4 {
    font-size: 1.12rem;
    /* 16px */
    line-height: 1.375rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    color: white;
}

h5 {
    font-size: 0.97rem;
    /* 16px */
    line-height: 1.25rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    font-weight: bold;
}

h6 {
    font-size: 0.93rem;
    /* 16px */
    line-height: 1rem;
    /* 16px */
    margin-bottom: 0.75rem;
    color: white;
}

@media (min-width: 980px) {
    h3.md-focus:before,
    h4.md-focus:before,
    h5.md-focus:before,
    h6.md-focus:before {
        color: #ddd;
        border: 1px solid #ddd;
        border-radius: 3px;
        position: absolute;
        left: -1.642857143rem;
        top: .357142857rem;
        float: left;
        font-size: 9px;
        padding-left: 2px;
        padding-right: 2px;
        vertical-align: bottom;
        font-weight: normal;
        line-height: normal;
    }

    h3.md-focus:before {
        content: 'h3';
    }

    h4.md-focus:before {
        content: 'h4';
    }

    h5.md-focus:before {
        content: 'h5';
        top: 0px;
    }

    h6.md-focus:before {
        content: 'h6';
        top: 0px;
    }
}

a {
    text-decoration: none;
    outline: 0;
}

a:hover {
    outline: 0;
}

a:focus {
    outline: thin dotted;
}

sup.md-footnote {
    background-color: #555;
    color: #ddd;
}

p {
    -ms-word-wrap: break-word;
    word-wrap: break-word;
}

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode {
    margin-top: 0;
    margin-bottom: 1.5rem;
    /* 24px */
}

li > blockquote {
	margin-bottom: 0;
}

audio:not([controls]) {
    display: none;
}

[hidden] {
    display: none;
}

::-moz-selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

*.in-text-selection,
::selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

ul,
ol {
    padding: 0 0 0 1.875rem;
    /* 30px */
}

ul {
    list-style: square;
}

ol {
    list-style: decimal;
}

ul ul,
ol ol,
ul ol,
ol ul {
    margin: 0;
}

b,
th,
dt,
strong {
    font-weight: bold;
}

i,
em,
dfn,
cite {
    font-style: italic;
}

blockquote {
    padding-left: 1.875rem;
    margin: 0 0 1.875rem 1.875rem;
    border-left: solid 2px #474d54;
    padding-left: 30px;
    margin-top: 35px;
}

pre,
code,
kbd,
tt,
var {
    background: rgba(0, 0, 0, 0.05);
    font-size: 0.875rem;
    font-family: Monaco, Consolas, "Andale Mono", "DejaVu Sans Mono", monospace;
}

kbd {
    padding: 2px 4px;
    font-size: 90%;
    color: #fff;
    background-color: #333;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
}

pre.md-fences {
    padding: 10px 30px;
    margin-bottom: 20px;
    border: 1px solid;
}

.md-fences .code-tooltip {
    bottom: -3.2em;
}

.enable-diagrams pre.md-fences[lang="sequence"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="flow"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="mermaid"] .code-tooltip {
    bottom: -2.2em;
    right: 4px;
}

code,
kbd,
tt,
var {
    padding: 2px 5px;
}

table {
    max-width: 100%;
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

th,
td {
    padding: 5px 10px;
    vertical-align: top;
}

a {
    -webkit-transition: all .2s ease-in-out;
    transition: all .2s ease-in-out;
}

hr {
    background: #474d54;
    /* variable */
}

h1 {
    margin-top: 2em;
}

a {
    color: #e0e0e0;
    text-decoration: underline;
}

a:hover {
    color: #fff;
}

.md-inline-math script {
    color: #81b1db;
}

b,
th,
dt,
strong {
    color: #DEDEDE;
    /* variable */
}

mark {
    background: #D3D40E;
}

blockquote {
    color: #9DA2A6;
}

table a {
    color: #DEDEDE;
    /* variable */
}

th,
td {
    border: solid 1px #474d54;
    /* variable */
}

.task-list {
    padding-left: 0;
}

.md-task-list-item {
    padding-left: 1.25rem;
}

.md-task-list-item > input {
    top: auto;
}

.md-task-list-item > input:before {
    content: "";
    display: inline-block;
    width: 0.875rem;
    height: 0.875rem;
    vertical-align: middle;
    text-align: center;
    border: 1px solid #b8bfc6;
    background-color: #363B40;
    margin-top: -0.4rem;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
    content: '\221A';
    /*◘*/
    font-size: 0.625rem;
    line-height: 0.625rem;
    color: #DEDEDE;
}

.CodeMirror-gutters {
    background: transparent;
    background: var(--bg-color);
    border-right: 1px solid transparent;
}

/** quick open **/
.auto-suggest-container {
    border: 0px;
    background-color: #525C65;
}

#typora-quick-open {
    background-color: #525C65;
}

#typora-quick-open input{
    background-color: #525C65;
    border: 0;
    border-bottom: 1px solid grey;
}

.typora-quick-open-item {
    background-color: inherit;
    color: inherit;
}

.typora-quick-open-item.active,
.typora-quick-open-item:hover {
    background-color: #4D8BDB;
    color: white;
}

.typora-quick-open-item:hover {
    background-color: rgba(77, 139, 219, 0.8);
}

.typora-search-spinner > div {
  background-color: #fff;
}

#write pre.md-meta-block {
    border-bottom: 1px dashed #ccc;
    background: transparent;
    padding-bottom: 0.6em;
    line-height: 1.6em;
}

.btn,
.btn .btn-default {
    background: transparent;
    color: #b8bfc6;
}

.ty-table-edit {
    border-top: 1px solid gray;
    background-color: #363B40;
}

.popover-title {
    background: transparent;
}

.md-image>.md-meta {
    color: #BBBBBB;
    background: transparent;
}

.md-expand.md-image>.md-meta {
    color: #DDD;
}

#write>h3:before,
#write>h4:before,
#write>h5:before,
#write>h6:before {
    border: none;
    border-radius: 0px;
    color: #888;
    text-decoration: underline;
    left: -1.4rem;
    top: 0.2rem;
}

#write>h3.md-focus:before {
    top: 2px;
}

#write>h4.md-focus:before {
    top: 2px;
}

.md-toc-item {
    color: #A8C2DC;
}

#write div.md-toc-tooltip {
    background-color: #363B40;
}

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus {
    color: white;
    background: black;
}

#toc-dropmenu {
    background: rgba(50, 54, 59, 0.93);
    border: 1px solid rgba(253, 253, 253, 0.15);
}

#toc-dropmenu .divider {
    background-color: #9b9b9b;
}

.outline-expander:before {
    top: 2px;
}

#typora-sidebar {
    box-shadow: none;
    border-right: 1px dashed;
    border-right: none;
}

.sidebar-tabs {
    border-bottom:0;
}

#typora-sidebar:hover .outline-title-wrapper {
    border-left: 1px dashed;
}

.outline-title-wrapper .btn {
    color: inherit;
}

.outline-item:hover {
    border-color: #363B40;
    background-color: #363B40;
    color: white;
}

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr {
    color: #8C8E92;
    display: inline;
}

.md-comment {
    color: #5a95e3;
    opacity: 1;
}

.md-inline-math g,
.md-inline-math svg {
    stroke: #b8bfc6 !important;
    fill: #b8bfc6 !important;
}

[md-inline='inline_math'] {
    color: #9CB2E9;
}

#math-inline-preview .md-arrow:after {
    background: black;
}

.modal-content {
    background: var(--bg-color);
    border: 0;
}

.modal-title {
    font-size: 1.5em;
}

.modal-content input {
    background-color: rgba(26, 21, 21, 0.51);
    color: white;
}

.modal-content .input-group-addon {
    background-color: rgba(0, 0, 0, 0.17);
    color: white;
}

.modal-backdrop {
    background-color: rgba(174, 174, 174, 0.7);
}

.modal-content .btn-primary {
    border-color: var(--primary-color);
}

.md-table-resize-popover {
    background-color: #4B535A;
}

.form-inline .input-group .input-group-addon {
    color: white;
}

#md-searchpanel {
    border-bottom: 1px dashed grey;
}

/** UI for electron */

.context-menu,
#spell-check-panel,
#footer-word-count-info {
    background-color: #42464A;
}

.context-menu.dropdown-menu .divider,
.dropdown-menu .divider {
    background-color: #777777;
}

footer {
    color: inherit;
}

@media (max-width: 1000px) {
    footer {
        border-top: none;
    }
    footer:hover {
        color: inherit;
    }
}

#file-info-file-path .file-info-field-value:hover {
    background-color: #555;
    color: #dedede;
}

.megamenu-content,
.megamenu-opened header {
    background: var(--bg-color);
}

.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn {
    color: inherit;
}

.megamenu-menu-panel input[type='text'] {
    background: inherit;
    border: 0;
    border-bottom: 1px solid;
}

#recent-file-panel-action-btn {
    background: inherit;
    border: 1px grey solid;
}

.megamenu-menu-panel .dropdown-menu > li > a {
    color: inherit;
    background-color: #2F353A;
    text-decoration: none;
}

.megamenu-menu-panel table td:nth-child(1) {
    color: inherit;
    font-weight: bold;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(1) {
    color: white;
}

.modal-footer .btn-default, 
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) {
    border: 1px solid;
    border-color: transparent;
}

.btn-default:hover, .btn-default:focus, .btn-default.focus, .btn-default:active, .btn-default.active, .open > .dropdown-toggle.btn-default {
    color: white;
    border: 1px solid #ddd;
    background-color: inherit;
}

.modal-header {
    border-bottom: 0;
}

.modal-footer {
    border-top: 0;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
    border: 1px solid #eee;
    background: transparent;
}

.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover {
    background-color: inherit;
}

.typora-node::-webkit-scrollbar {
    width: 5px;
}

.typora-node::-webkit-scrollbar-thumb:vertical {
    background: rgba(250, 250, 250, 0.3);
}

.typora-node::-webkit-scrollbar-thumb:vertical:active {
    background: rgba(250, 250, 250, 0.5);
}

#w-unpin {
    background-color: #4182c4;
}

#top-titlebar, #top-titlebar * {
    color: var(--item-hover-text-color);
}

.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count {
    background: #333333;
}

#toggle-sourceview-btn:hover {
    color: #eee;
    background: #333333;
}

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * {
    color: #686868 !important;
}

.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container)>input {
    opacity: #686868 !important;
}

.on-focus-mode li[cid]:not(.md-focus-container){
    color: #686868;
}

.on-focus-mode .md-fences.md-focus .CodeMirror-code>*:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * {
    color: #686868 !important;
}

.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container {
    color: #fff;
}

.on-focus-mode #typora-source .CodeMirror-code>*:not(.CodeMirror-activeline) * {
    color: #686868 !important;
}


/*diagrams*/
#write .md-focus .md-diagram-panel {
    border: 1px solid #ddd;
    margin-left: -1px;
    width: calc(100% + 2px);
}

/*diagrams*/
#write .md-focus.md-fences-with-lineno .md-diagram-panel {
    margin-left: auto;
}

.md-diagram-panel-error {
    color: #f1908e;
}

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover {
    color: #eee;
}

.sidebar-footer-item:hover,
.footer-item:hover {
    background: inherit;
    color: white;
}

.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after {
    color: white;
}

#sidebar-files-menu {
    border:solid 1px;
    box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.79);
    background-color: var(--bg-color);
}

.file-list-item {
    border-bottom:none;
}

.file-list-item-summary {
    opacity: 1;
}

.file-list-item.active:first-child {
    border-top: none;
}

.file-node-background {
    height: 32px;
}

.file-library-node.active>.file-node-content,
.file-list-item.active {
    color: white;
    color: var(--active-file-text-color);
}

.file-library-node.active>.file-node-background{
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}
.file-list-item.active {
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}

#ty-tooltip {
    background-color: black;
    color: #eee;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: 0.3rem;
    -webkit-appearance: none;
}

.md-mathjax-midline {
    background-color: #57616b;
    border-bottom: none;
}

footer.ty-footer {
    border-color: #656565;
}


</style><title>蓝队</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='蓝队'><span>蓝队</span></h1><h1 id='213日志流量'><span>213：日志流量</span></h1><p><span>资料中有手册-----应急响应------win+linux</span></p><p><span>日志：中间件日志-----开没开日志、日志保存路径改没改</span></p><p><span>写报告：攻击链、攻击时间，攻击点，漏洞、干了什么事情，修复建议、攻击的工具。</span></p><p><span>小案例、分开讲-------分知识点讲解：</span></p><p><span>31min   IIS +  .net  看日志    ----------小翻车、换个IIS的机子36min  看日志。POST的请求没有记录提交记录</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105180640678.png" referrerpolicy="no-referrer" alt="image-20250105180640678"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105180947137.png" referrerpolicy="no-referrer" alt="image-20250105180947137"></p><p><span>先发现是有sqlmap，可能有sql注入，再看注入点为default.aspx  再看返回的状态码为200，那么就可以判断是遭受了sql注入攻击并且成功：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105183738436.png" referrerpolicy="no-referrer" alt="image-20250105183738436"></p><p><span>采用post注入成功、可以发现post请求没有记录提交</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105184620414.png" referrerpolicy="no-referrer" alt="image-20250105184620414"></p><p><span>43min  php+apache  这里为thinkphp的网页      看apache的日志logs  2个程序日志error 和httpd：</span></p><p><span>先找到web的对应apache下的日志记录、这里的日志就主要看打对勾的几个：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105190215366.png" referrerpolicy="no-referrer" alt="image-20250105190215366"></p><p><span>模拟攻击，然后查看日志:</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105191226791.png" referrerpolicy="no-referrer" alt="image-20250105191226791"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105191315610.png" referrerpolicy="no-referrer" alt="image-20250105191315610"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105191338586.png" referrerpolicy="no-referrer" alt="image-20250105191338586"></p><h4 id='2'><span>2</span></h4><p><span>卡了到第二节课</span></p><p><span>找apache的日志。</span></p><p><span>2min     web +tomcat   看日志，找后门文件：用一些在线或者本地下载的工具，还有蓝队应急响应工具箱：可以扫到后门，扫到后然后就在tomcat里看日志文件---一般日志为access的log文件就是记录登录访问的。</span></p><p><span>9min  演示后台拿tomcat拿shell过程。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105224550644.png" referrerpolicy="no-referrer" alt="image-20250105224550644"></p><p><span>这里注意，2.war后需要将后门放一个目录就行，如1所示。序号2就是多了一层目录2，就等于需要访问2/2/2.jsp才能访问到。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105225206515.png" alt="image-20250105225206515" style="zoom:50%;" /></p><p><span>这里用2.war就只需要访问一层 2/2.jsp就可以访问到：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105225330854.png" referrerpolicy="no-referrer" alt="image-20250105225330854"></p><p><span>然后下来就是看tomcat的日志：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105225943538.png" referrerpolicy="no-referrer" alt="image-20250105225943538"></p><p><span>就可以发现2.jsp后门，然后分析：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105230238342.png" referrerpolicy="no-referrer" alt="image-20250105230238342"></p><p><span>如果这里2.jsp是免杀的或者我们发现不了他是哥斯拉后门，或者2.jsp不存在，那么下来就是看流量包了。</span></p><p><span>16min  模拟攻击流程 ，捕获流量。这里用wireshark代理edr流量设备。下来就是看哥斯拉的数据包，哥斯拉流量特征、用工具解密哥斯拉的java数据包，就可以知道是哥斯拉连接。</span></p><p><span>这里注意：wireshark抓包时候，抓不到本地操作的包，就是说如果你是在本地用哥斯拉操作本地的服务器，就是在主机上连接127.0.0.1的web后执行的流量是抓不到，这里是用kali上的哥斯拉操作，抓到的流量，抓的也是vm的网卡上的流量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105232934574.png" referrerpolicy="no-referrer" alt="image-20250105232934574"></p><p><span>流量特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250105233111331.png" referrerpolicy="no-referrer" alt="image-20250105233111331"></p><p><span>还可以将捕获到的流量包放蓝队工具箱中解密：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106002213797.png" referrerpolicy="no-referrer" alt="image-20250106002213797"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106002331063.png" referrerpolicy="no-referrer" alt="image-20250106002331063"></p><p><span>返回包解密：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106002717106.png" referrerpolicy="no-referrer" alt="image-20250106002717106"></p><p><span>26min  有的日志中可能没有记录或者日志就没有开，那么就需要看流量包来看-----打开靶场（jar包，开数据库），shiro漏洞，（这里都是先模拟攻击者攻击后然后蓝队人员如何排查）捕获到流量包后解密。这里是用jar包开的靶场，这种的日志就在命令终端中，没有记录的。：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106003217037.png" referrerpolicy="no-referrer" alt="image-20250106003217037"></p><p><span>有些日志中的记录可能还是加密过的，有时候还看不出来。这里测试shiro框架的流量。</span></p><p><span>还是将环境放到虚拟机中，在本机进行抓虚拟机的包，因为本机抓本机流量抓不到：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106005102532.png" referrerpolicy="no-referrer" alt="image-20250106005102532"></p><p><span>抓包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106005201546.png" referrerpolicy="no-referrer" alt="image-20250106005201546"></p><p><span>抓到shiro框架的流量rememberMe 后放到解密：</span></p><p><span>踩坑1、追踪http流，踩坑2、解密的只有rememberMe 后面的密文，不带rememberMe= </span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106010215135.png" referrerpolicy="no-referrer" alt="image-20250106010215135"></p><p><span>39min  另一款蓝队工具</span></p><p><span>就是用来破解一些加密流量，打一些OA系统时候会用加密流量打，这款工具就方便我们解密流量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106010424745.png" referrerpolicy="no-referrer" alt="image-20250106010424745"></p><p><span>日志中的post包没有记录怎么办呢？就看流量包，里面的post有记录。</span></p><p><span>46min  web工具就看Web日志，入侵到服务器就看系统日志。</span></p><h1 id='214c2检测'><span>214：c2检测</span></h1><p><span>蓝队：封锁----溯源-----反制</span></p><h4 id='检测'><span>检测</span></h4><p><span>常规c2后门检测：</span></p><p><span>13min     火绒剑，可以查看本地和外面的连接情况，还有可以看安全状态。爆红的需要注意。然后就找到后门后自己判断，完了上传微步、云沙箱。还可以用工具打开检测，还有看应急响应手册看一些可以上传后门的在线监测平台。</span></p><p><span>定性：后门为哪种c2工具，msf cs viper sliver vshell havoc 响尾蛇等</span></p><p><span>人工分析：数据包流量，文件逆向分析。平台分析：文件或者IP域名。</span></p><p><span>火绒剑：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106200649237.png" referrerpolicy="no-referrer" alt="image-20250106200649237"></p><p><span>找到后门可疑文件后，然后直接提交微步这类平台或者用工具箱中的威胁情报查询：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106201119019.png" referrerpolicy="no-referrer" alt="image-20250106201119019"></p><h4 id='封锁'><span>封锁</span></h4><p><span>31min  处置   清理：进程结束后删除、    </span></p><p><span> ：防火墙封锁：1、进程名   2、网络限制     3、限制协议</span></p><p><span>40min   防火墙演示            ip 封锁 或者进程封锁</span><span>	</span><span>类似于aliyun的安全组</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106202135288.png" referrerpolicy="no-referrer" alt="image-20250106202135288"></p><p><span>在出站阻止程序：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106202545191.png" referrerpolicy="no-referrer" alt="image-20250106202545191"></p><p><span>封ip：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106202925911.png" referrerpolicy="no-referrer" alt="image-20250106202925911"></p><p><span>还可以通过协议封。</span></p><h4 id='排查'><span>排查</span></h4><p><span>52min  火绒剑查看启动项-----看有没有一些维权的后门</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106203530949.png" referrerpolicy="no-referrer" alt="image-20250106203530949"></p><p><span>就可以在启动项里进行排查：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106204022090.png" referrerpolicy="no-referrer" alt="image-20250106204022090"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106204358404.png" referrerpolicy="no-referrer" alt="image-20250106204358404"></p><h4 id='基线检测'><span>基线检测</span></h4><h4 id='windows'><span>windows</span></h4><p><span>58min   基线检测：属于应急响应后面部分，结束处理后门后，就要提出修复建议，指出一些潜在威胁（哎，就是水报告一样，水任务的）混的。骗客户的。</span></p><p><span>golin  需要管理员运行，运行后会对当前系统进行扫描。</span></p><p><span>d-eyes推荐，监测当前全部在威胁</span></p><p><span>两款检测自身的软件    ------- golin和 windows基线：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106215749168.png" referrerpolicy="no-referrer" alt="image-20250106215749168"></p><h5 id='findall'><span>findall</span></h5><p><span>检测工具：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106220121291.png" referrerpolicy="no-referrer" alt="image-20250106220121291"></p><p><span>检测目标就是将服务端上传到目标主机上执行，然后在c盘下产生文件result.hb，将此文件放到刚才的客户端中进行分析（这里运行都是管理员）：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106220856694.png" referrerpolicy="no-referrer" alt="image-20250106220856694"></p><p><span>得到分析结果：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106221023432.png" referrerpolicy="no-referrer" alt="image-20250106221023432"></p><h5 id='d-eye'><span>d-eye</span></h5><p><a href='https://github.com/m-sec-org/d-eyes' target='_blank' class='url'>https://github.com/m-sec-org/d-eyes</a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106221712578.png" referrerpolicy="no-referrer" alt="image-20250106221712578"></p><h4 id='linux'><span>linux： </span></h4><p><span>1h15min   linux 中进行检测可能存在威胁</span></p><p><a href='https://github.com/sun977/linuxcheckshoot' target='_blank' class='url'>https://github.com/sun977/linuxcheckshoot</a><span>       可以看到一些威胁软件，特权命令，定时任务等</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106222822139.png" referrerpolicy="no-referrer" alt="image-20250106222822139"></p><p><a href='https://github.com/m-sec-org/d-eyes' target='_blank' class='url'>https://github.com/m-sec-org/d-eyes</a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106223247547.png" referrerpolicy="no-referrer" alt="image-20250106223247547"></p><p><a href='https://github.com/selinuxG/Golin' target='_blank' class='url'>https://github.com/selinuxG/Golin</a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106223522723.png" referrerpolicy="no-referrer" alt="image-20250106223522723"></p><p><span>1h26min  linux 上线cs           cs后门的心跳包原因，所以导致在linux中会找不到通讯地址，就是有延迟</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106224315652.png" referrerpolicy="no-referrer" alt="image-20250106224315652"></p><p><span>执行命令产生linux后门、踩坑：这里细看，上面cs插件生成linux的为https 所以我们监听器也应该为https，这里是http的监听器，所以没有上线成功，重新走一遍成功上线：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106225116587.png" referrerpolicy="no-referrer" alt="image-20250106225116587"></p><p><span>上线后发现，linux没有开对应通讯连接，这里就是因为cs的心跳包导致的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106225457544.png" referrerpolicy="no-referrer" alt="image-20250106225457544"></p><p><span>用刚才的检测工具来检测网络也没有发现有对外的连接，所以这就是cs的好处。msf就没有：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106225635573.png" referrerpolicy="no-referrer" alt="image-20250106225635573"></p><p>&nbsp;</p><p><span>1h34min  msf  linux上线       这下就可以看到通讯了，然后就可以用刚才的工具检测出来后门存在。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106230547085.png" referrerpolicy="no-referrer" alt="image-20250106230547085"></p><p><span>msf没有心跳包，那么就可以检测出来通讯：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250106230456031.png" referrerpolicy="no-referrer" alt="image-20250106230456031"></p><h1 id='215挖矿'><span>215：挖矿</span></h1><p><span>数字货币、现象：cpu/gpu拉满，网络堵塞，服务器卡顿。</span></p><p><span>分析：进程找到文件，生成平台分析、网络找到外链，生成ip分析</span></p><p><span>处置：排查入口攻击点，重启隔离主机，排查重启生效项（启动项，计划计时任务等）可以将挖矿病毒放到启动任务中。</span></p><h4 id='windows-2'><span>windows</span></h4><h5 id='1'><span>1</span></h5><p><span>14min    挖矿病毒在计算器重启后还是会自动运行。就需要删除后门。</span></p><p><span>xmref&#39;    挖矿病毒还要找到是哪个家族，执行后cpu拉满，而且还需要找有没有留后门自启动的</span></p><p><span>启动挖矿进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171359322.png" referrerpolicy="no-referrer" alt="image-20250107171359322"></p><p><span>然后结束update64进程，重启电脑发现进程自己启动：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171830734.png" referrerpolicy="no-referrer" alt="image-20250107171830734"></p><p><span>上传微步分析域名，确定为挖矿进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171949286.png" referrerpolicy="no-referrer" alt="image-20250107171949286"></p><p><span>用火绒剑也发现启动项中有这个进程，应该是伪装为google的，来实现调用挖矿进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107172223936.png" referrerpolicy="no-referrer" alt="image-20250107172223936"></p><p><span>将其禁用删除可能会删除失败，就先将对应进程结束，再查看注册表删除注册表后，重启查看是否清理干净：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107172543475.png" referrerpolicy="no-referrer" alt="image-20250107172543475"></p><h5 id='2-2'><span>2:</span></h5><p><span>xmrig.exe</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173341258.png" referrerpolicy="no-referrer" alt="image-20250107173341258"></p><p><span>还是很容易发现的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173511565.png" referrerpolicy="no-referrer" alt="image-20250107173511565"></p><p><span>分析文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173617639.png" referrerpolicy="no-referrer" alt="image-20250107173617639"></p><p><span>查看配置：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173658776.png" referrerpolicy="no-referrer" alt="image-20250107173658776"></p><p><span>分析url，基本锁定为挖矿：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173741255.png" referrerpolicy="no-referrer" alt="image-20250107173741255"></p><h5 id='3'><span>3</span></h5><p><span>排查方式和上面一样：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107174100061.png" referrerpolicy="no-referrer" alt="image-20250107174100061"></p><h4 id='linux-2'><span>linux</span></h4><p><span> 30min update.sh  写任务，下载病毒，在主机上把别的挖矿病毒停了（让自己的脚本不会被影响），把自己的样本放上去。然后在写维权。</span></p><p><strong><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175001727.png" referrerpolicy="no-referrer" alt="image-20250107175001727"></strong></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175254452.png" referrerpolicy="no-referrer" alt="image-20250107175254452"></p><p>&nbsp;</p><p><span>36min   现象也是cpu拉满，网络卡顿。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107102200706.png" referrerpolicy="no-referrer" alt="image-20250107102200706"></p><p><span>这种就是将sh加密处理的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175431840.png" referrerpolicy="no-referrer" alt="image-20250107175431840"></p><p><span>还有将脚本编译的，要看里面的内容需要将反编译出来：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175533539.png" referrerpolicy="no-referrer" alt="image-20250107175533539"></p><h4 id='1-2'><span>1：</span></h4><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175714105.png" referrerpolicy="no-referrer" alt="image-20250107175714105"></p><p><span>cpu拉满，还会对外通讯：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107180536165.png" referrerpolicy="no-referrer" alt="image-20250107180536165"></p><p><span>top命令查看进程，找到占用cpu的进程PID，直接kill -9 就行：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107181004619.png" referrerpolicy="no-referrer" alt="image-20250107181004619"></p><p><span>44min </span></p><h5 id='靶场'><span>靶场：</span></h5><p><span>这里环境懒，没有配， 以xd的视频为主。</span></p><p><span>找到可疑文件，打开cinfig文件发现存在url，检测为矿池url。是先封堵在清理后门，而不是直接清理。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107190713565.png" referrerpolicy="no-referrer" alt="image-20250107190713565"></p><p><span>发现有大量的外部连接：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107190934217.png" referrerpolicy="no-referrer" alt="image-20250107190934217"></p><p><span>思路一样，还是找到占用率高的文件，打开里面的配置文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191017205.png" referrerpolicy="no-referrer" alt="image-20250107191017205"></p><p><span>上传在线的平台分析、基本确定为挖矿：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191053427.png" referrerpolicy="no-referrer" alt="image-20250107191053427"></p><p><span>先堵入口，在清理后门：</span></p><p><span>下来的思路：看他是怎么打进来的。先排查服务器上的资产信息-----看有没有什么web服务，或者其他一些漏洞，弱口令，钓鱼等，是不是内网机器，内网打进来的。看日志排查：本台机器中是通过爆破进来的，看系统日志。</span></p><p><span>看程序时间，基本定位入侵进来的时间：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191226878.png" referrerpolicy="no-referrer" alt="image-20250107191226878"></p><p><span>netstat -anpt  查看是否有web，这里没有web服务，所以就看系统日志：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191548755.png" referrerpolicy="no-referrer" alt="image-20250107191548755"></p><p><span>根据刚才的时间，然后再看登录成功和登录失败的临界点，就是符合攻击者一直测试然后进来的情况，总不能一次就登录成功了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191952881.png" referrerpolicy="no-referrer" alt="image-20250107191952881"></p><p><span>可以查事件id：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192639573.png" referrerpolicy="no-referrer" alt="image-20250107192639573"></p><p><span>下来就是进行封堵，开个防火墙，封ip，改密码之类操作。</span></p><p>&nbsp;</p><p><span>1h 发现入口，利用解题系统（蓝队工具），下来就是清理挖矿病毒，结束进程，结束不掉，可能是计划任务影响的，就找到计划任务删除任务，但是发现还是结束不了进程，然后就在服务中找，找到了调用病毒的服务，禁用在删除服务，在结束进程就可以。</span></p><p><span>结束进程后又自己启动，这种多半就是计划任务或者服务里有启动的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192925211.png" referrerpolicy="no-referrer" alt="image-20250107192925211"></p><p><span>计划任务：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192957932.png" referrerpolicy="no-referrer" alt="image-20250107192957932"></p><p><span>删除计划任务后发现还是没法终止挖矿进程，那就在看看服务中是否还有对应的在运行，停止可疑服务，删除服务就需要在命令终端中敲del .........：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193251920.png" referrerpolicy="no-referrer" alt="image-20250107193251920"></p><p><span>停止服务后就可以结束进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193552740.png" alt="image-20250107193552740" style="zoom:67%;" /></p><p><span>下来就是防护，但是发现重启后，电脑又自己执行命令，然后开始执行了挖矿程序，这里发现是刚才的计划任务中的遗留bat文件没有删除，刚才只是删除了计划任务，没有删除计划任务调用的程序。然后再封ip后期。反正就是将他维权的一系列留下来的操作找到并清理干净，使用重启看是否清除干净。</span></p><p><span>重启电脑后刚才本来都结束的进程和删除的挖矿文件又启动出来，而且会自己运行一段命令窗口：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193941026.png" referrerpolicy="no-referrer" alt="image-20250107193941026"></p><p><span>可以从上面的计划任务中看到，你只是删除了计划任务，但是没有删除他调用的bat文件，所以没有清理干净，这个bat文件会调用过程已经禁用的服务，从而执行任务。那实战中你如果刚才忘了删bat文件，现在回去发现计划任务已经被你删了，找不到对应的bat文件在哪儿了，这时候就看刚才刚开机执行的那个命令行，从里面找信息，查到bat的路径：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107194219306.png" referrerpolicy="no-referrer" alt="image-20250107194219306"></p><p><span>下来还是将刚才的服务停止：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107194322012.png" referrerpolicy="no-referrer" alt="image-20250107194322012"></p><p><span>然后在重启就没事了，这时候才清理干净，下来就是防护，防火墙拉黑，改密码后续。</span></p><p>&nbsp;</p><h3 id='后面看'><span>后面看</span></h3><p><span>1h19min   linux    上期164day  可以看。这里vm的版本不合适。</span></p><p><a href='https://mp.weixin.qq.com/s/OuzkbDRVqeNmH_kgptjwug' target='_blank' class='url'>https://mp.weixin.qq.com/s/OuzkbDRVqeNmH_kgptjwug</a></p><p><span>找到了进程文件，但是删除不了，上锁了，就需要解锁，再将几个核心的文件删除，再结束进程删除文件。</span></p><p>&nbsp;</p><p>&nbsp;</p><h1 id='216勒索'><span>216：勒索</span></h1><p><span>也是数字货币或者区块链</span></p><p><span>危害较大，解密难，遇到了就交钱吧，，，原理是将你电脑上的许多文件进行加密，你自己看不了，只能支付赎金。</span></p><p><span>传播方式和挖矿进入的方式一样。也有家族分类。</span></p><p><span>不可逆的加密：</span></p><p><span>记得快照，样本在虚拟机中：23min  还是可以上传到平台定性，然后解密，不过大部分自己都解密不了。下来就是找人帮解密。</span></p><p><span>特征就是自己的文件后缀异常，然后打开内容是被加密的</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222500983.png" referrerpolicy="no-referrer" alt="image-20250108222500983"></p><p><span>正常文件的后缀变了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222601570.png" referrerpolicy="no-referrer" alt="image-20250108222601570"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222718040.png" referrerpolicy="no-referrer" alt="image-20250108222718040"></p><p><span>可以将中毒的文件上传到一些平台上检测：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108223055123.png" referrerpolicy="no-referrer" alt="image-20250108223055123"></p><p><span>40min  可逆的加密方式：可以解的勒索病毒。有工具，这里是通过勒索的邮箱人工分析到勒索病毒的解密工具，</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108235834108.png" referrerpolicy="no-referrer" alt="image-20250108235834108"></p><p><span>这款可以解密：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109000150851.png" referrerpolicy="no-referrer" alt="image-20250109000150851"></p><p><span>使用解密工具成功解密，就是需要将要解密的文件放一起，放在解密文件路径下：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109001217168.png" referrerpolicy="no-referrer" alt="image-20250109001217168"></p><p>&nbsp;</p><p><span>49min  linux勒索</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108214959501.png" referrerpolicy="no-referrer" alt="image-20250108214959501"></p><p>&nbsp;</p><p><span>1h02min  勒索病毒的防范，注意入口封锁。</span></p><h1 id='217钓鱼防范'><span>217：钓鱼防范</span></h1><p><span>主要还是溯源，根据发件人地址。</span></p><p><span>7min 可以看邮件的eml文件，从里面获取相关信息进而溯源。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109203524656.png" referrerpolicy="no-referrer" alt="image-20250109203524656"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109203715723.png" referrerpolicy="no-referrer" alt="image-20250109203715723"></p><p><span>17min  真实钓鱼 </span></p><p><span>下面这种，他两个域名不一样，钓鱼用的为白名单域名，但是底下为什么不用白名单呢，一方面是因为防溯源，一方面是会收到白名单域名官方的管制。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109204252890.png" referrerpolicy="no-referrer" alt="image-20250109204252890"></p><p><span>明显为钓鱼的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109204541325.png" referrerpolicy="no-referrer" alt="image-20250109204541325"></p><p><span>31min  对钓鱼文件进行定性分析，蠕虫病毒，这钓鱼文件还是做过免杀的，里面有防沙箱，虚拟机，防逆向的。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109205722002.png" referrerpolicy="no-referrer" alt="image-20250109205722002"></p><p>&nbsp;</p><p><span>43min 在服务器中运行</span></p><p><span>在自己本地上也运行一下安天的分析工具，看看自己主机上有没有后门（ctf那个程序）</span></p><p><span>53min  分析后门。在你的主机上获取你的所有邮件信息，然后尝试将他的邮件文件（后门文件）通过你的邮件账户发送到各个地方，典型蠕虫病毒。这里就是需要逆向和二进制的知识。</span></p><p><span>就是自己中毒了，但不会分析，还可以就是找这个毒，看有没有人分析过。：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109210753248.png" referrerpolicy="no-referrer" alt="image-20250109210753248"></p><h5 id='考你'><span>考你：</span></h5><p><span>1h02min  面试或者比赛  有时候会给你一个文件，让你分析这是啥。这里分析的文件里面为白名单域名，但是有时候是白名单域名也不一定是白的，他有可能被别人拿下整个服务器然后利用来攻击，</span></p><p><span>有附件和没附件的邮件的eml内容不同</span></p><p><span>给你一个，check.eml，让你开始分析有没有危害，什么危害：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109210906973.png" referrerpolicy="no-referrer" alt="image-20250109210906973"></p><p><span>开始查，找：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109211239676.png" referrerpolicy="no-referrer" alt="image-20250109211239676"></p><p><span>初步判断为垃圾钓鱼，还需要深入调查，那就得根据里面内容或者附件确认了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109211604910.png" referrerpolicy="no-referrer" alt="image-20250109211604910"></p><p><span>kali ------base64解码：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212133047.png" referrerpolicy="no-referrer" alt="image-20250109212133047"></p><p><span>解码后里面提示有解压密码，那么就猜测是不是有压缩包，而且有filename和application这种特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212306086.png" referrerpolicy="no-referrer" alt="image-20250109212306086"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212608463.png" referrerpolicy="no-referrer" alt="image-20250109212608463"></p><p><span>基本确定是有附件的，那么目前是只给了你一个eml，没有附件。那就得将下面那些加密的数据导出为附件：</span></p><p><span>那么一般为zip文件，但是也有可能为rar，所以我们在将filename解码：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213208421.png" referrerpolicy="no-referrer" alt="image-20250109213208421"></p><p><span>那就用kali将他导出：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213645803.png" referrerpolicy="no-referrer" alt="image-20250109213645803"></p><p><span>上传微步，查找资料定性：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213818988.png" referrerpolicy="no-referrer" alt="image-20250109213818988"></p><p><span>木马家族：Rozena</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109215052307.png" referrerpolicy="no-referrer" alt="image-20250109215052307"></p><h1 id='218爆破'><span>218：爆破</span></h1><p><span>外网爆破成功率比较低。内网爆破比较常见，成功率较高。</span></p><p><span>内网容易爆破，一方面是方便运营，还有也是因为内网本身就安全，你很难通讯到内网。</span></p><h4 id='linux---ssh'><span>linux---ssh</span></h4><p><span>面试问过：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109225720973.png" referrerpolicy="no-referrer" alt="image-20250109225720973"></p><p><span>unbutu 的日志在/var/log/auth.log：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121232616.png" referrerpolicy="no-referrer" alt="image-20250110121232616"></p><p><span>13min   爆破测试，查看日志。----16min      ssh爆破</span></p><p><span>没爆破前看日志中的成功和失败都没有：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121725469.png" referrerpolicy="no-referrer" alt="image-20250110121725469"></p><p><span>爆破后查看：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121849377.png" referrerpolicy="no-referrer" alt="image-20250110121849377"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121948961.png" referrerpolicy="no-referrer" alt="image-20250110121948961"></p><p>&nbsp;</p><h4 id='windows-3'><span>windows</span></h4><p><span>这里有RDP、SMB没有wmi是因为wmi不会再目标日志系统留下痕迹，所以没有日志可以分析。</span></p><p><span>25min   RDP安全日志  看关键字和事件ID     事件ID：4625/4624      登录失败/成功         登陆类型：2/3/5/10这几种类型也需要留意，一般就是爆破类型。</span></p><p><span>这里看时间也可以判断为爆破，一秒的登录次数：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110123742101.png" referrerpolicy="no-referrer" alt="image-20250110123742101"></p><p><span>爆破失败的id和类型：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110123818366.png" referrerpolicy="no-referrer" alt="image-20250110123818366"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110124111430.png" referrerpolicy="no-referrer" alt="image-20250110124111430"></p><p><span>清除日志也会记录：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145209569.png" referrerpolicy="no-referrer" alt="image-20250110145209569"></p><p><span>38min  SMB</span></p><p><span>sql（32）攻击dc（21）机</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145548270.png" referrerpolicy="no-referrer" alt="image-20250110145548270"></p><p>&nbsp;</p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145637220.png" referrerpolicy="no-referrer" alt="image-20250110145637220"></p><p>&nbsp;</p><p><span>MSSQL</span></p><p><span>45min sql 应用的日志存储。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145946390.png" referrerpolicy="no-referrer" alt="image-20250110145946390"></p><p><span>web（31）攻击sql</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110150446085.png" referrerpolicy="no-referrer" alt="image-20250110150446085"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110150824070.png" referrerpolicy="no-referrer" alt="image-20250110150824070"></p><p>&nbsp;</p><p><span>FTP日志，找谁搭建的ftp就看谁的日志。谁提供的就找谁，不是日志都在windows系统里。</span></p><h4 id='隧道技术'><span>隧道技术</span></h4><p><span>当收到攻击者是通过隧道技术进来的，我们怎么处置发现。</span></p><p><span>linux ------ icmp：1h03min    socks是代不出来icmp协议，icmp是底层协议。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110154103179.png" referrerpolicy="no-referrer" alt="image-20250110154103179"></p><p><span>centos是我们的受害机，被攻击者建立了icmp通道进行通讯，我们需要找到通道并且关闭。</span></p><p><span>使用工具可以捕获到icmp数据包的连接情况，找到发起icmp的进程id，来结束进程。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152157879.png" referrerpolicy="no-referrer" alt="image-20250110152157879"></p><p><span>然后在centos的机器上是看不到icmp的包对外的情况，为:::*    就是不知道远程ip，用这种netstat -anpt这种通讯是看不到icmp的网络流量。因为正常来说应该是和上面一样，有本地和远程ip的端口显示：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152236816.png" referrerpolicy="no-referrer" alt="image-20250110152236816"></p><p><span>所以网络是正常来说分析不到，那么就得借助工具来对icmp进行监控：</span></p><p><a href='https://blog.csdn.net/native_lee/article/details/124751325'><span>bpftrace对icmp进行监控，查看icmp包是哪个进程发出的_linux bpftrace跟踪发网络报文进程-CSDN博客</span></a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152558787.png" referrerpolicy="no-referrer" alt="image-20250110152558787"></p><p><span>上传工具：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152752693.png" referrerpolicy="no-referrer" alt="image-20250110152752693"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153212916.png" referrerpolicy="no-referrer" alt="image-20250110153212916"></p><p><span>监听找到icmp的行为：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153543455.png" referrerpolicy="no-referrer" alt="image-20250110153543455"></p><p><span>查看pid对应的进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153700053.png" referrerpolicy="no-referrer" alt="image-20250110153700053"></p><p><span>下来就是kill这个进程，然后删除对应的进程文件。</span></p><p><span>1h12min  windows---icmp</span></p><p><span>windwos自带监测icmp数据包，可以找到icmp的进程，进而找到发起进程的工具文件，然后分析。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110154914730.png" referrerpolicy="no-referrer" alt="image-20250110154914730"></p><p><span>使用wireshark监听受害机的eth1网卡（和攻击机通讯）：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110155029360.png" referrerpolicy="no-referrer" alt="image-20250110155029360"></p><p><span>这里还是只能分析到网络流量，但是无法知道进程和谁发起的这个进程，我们怎么阻止找到这个发起进程的文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110155202805.png" referrerpolicy="no-referrer" alt="image-20250110155202805"></p><p><span>这里用到的是一款微软自带的抓包工具MessageAnalyzer，当然不止能抓icmp，还有Dns这些都可以，然后记得管理员运行才可以，抓到对应的icmp包后查看进程信息：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110160105494.png" referrerpolicy="no-referrer" alt="image-20250110160105494"></p><p><span>注意：上面的icmp包要分析找对，别分析半天发现不是攻击者的那个数据包。</span></p><p><span>然后查看pid后用进程查看工具（火绒剑）找到对应进程pid，就可以锁定对应的进程文件，进而清除或者分析溯源：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110160743375.png" referrerpolicy="no-referrer" alt="image-20250110160743375"></p><h1 id='219docker'><span>219：docker</span></h1><p><span>近源+docker</span></p><p><span>7min  docker中的镜像被植入挖矿病毒。服务器上有一个进程占用cpu，然后kill后也会自己启动，但找不到对应的文件，然后就发现这个进程运行在docker镜像里。</span></p><p><span>先top命令发现有占用cpu过大的进程：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111152810757.png" referrerpolicy="no-referrer" alt="image-20250111152810757"></p><p><span>ps -aux  查看进程，根据上面的top找到的pid号来查看进程所在的位置，发现在当前目录：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153000766.png" referrerpolicy="no-referrer" alt="image-20250111153000766"></p><p><span>然后 查看当前目录没有发现对应的文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153132042.png" referrerpolicy="no-referrer" alt="image-20250111153132042"></p><p><span>然后在看刚才的top进程中发现有个systemd的进程，这个一般就是 docker镜像进程运行的一个进程，那么结合我们刚才找不到进程文件，而且kill也结束不了进程，所以判断这个进程是在docker容器里：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153227041.png" referrerpolicy="no-referrer" alt="image-20250111153227041"></p><p><span>那下来就看docker来进一步排查了：</span></p><p><span>1、查看dokcer进程 </span><span>	</span><span>2、看这个进程对应的历史命令     3、根据刚才top找到进程名为xmrig，所以只找有xmrig信息的。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153745211.png" referrerpolicy="no-referrer" alt="image-20250111153745211"></p><p><span>然后从上面也可以发现，这个文件似乎在 /home/miner/xmrig下。但是我们没有找到，那是因为这个镜像是在docker里，不在我们的本机上：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154122847.png" referrerpolicy="no-referrer" alt="image-20250111154122847"></p><p><span>然后就进入docker容器，发现了目标xmrig文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154312151.png" referrerpolicy="no-referrer" alt="image-20250111154312151"></p><p><span>那下来自然就很明显了，结束这个进程然后删除文件就行。当然不会这么简单，这里发现，结束进程后他又运行：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154923906.png" referrerpolicy="no-referrer" alt="image-20250111154923906"></p><p><span>22min  alils      dokcer和本机的关系就类似是虚拟机和本地之间的关系。那么就很清楚了，那么docker上的镜像文件自然也是在真机上。       我们就在docker上找到对应占用服务器进程的镜像，在找dokcer上的镜像的位置，在找其在真机下对应的位置。            先找镜像在哪----------&gt;找到镜像在docker里的存储位置--------&gt;在找对应在真机里的存储位置。   和虚拟机一样，找虚拟机里的文件，也是先找虚拟机在真机里的存储位置，在找其文件在真机里的位置</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155616068.png" referrerpolicy="no-referrer" alt="image-20250111155616068"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155410024.png" referrerpolicy="no-referrer" alt="image-20250111155410024"></p><p><span>使用dfimage从镜像中提取Dockerfile，在这里可以清晰地看到恶意镜像构建的过程。就是用dfimage可以看你的镜像到底是咋弄的，怎么运行起来的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155550397.png" referrerpolicy="no-referrer" alt="image-20250111155550397"></p><p><span>这里就是docker的磁盘路径，dokcer会加载许多磁盘路径，下来就是我们一个一个试，看刚才对应文件是在/home/miner/xmrig/build 下，其实这是docker的路径下，我们就需要找看是在哪个磁盘路径下存储着：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155711552.png" referrerpolicy="no-referrer" alt="image-20250111155711552"></p><p><span>那找到文件下来就简单了，先传出来定性判断一下，在删除文件后再kill 进程，然后发现他就不会在继续重新运行了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111160146797.png" referrerpolicy="no-referrer" alt="image-20250111160146797"></p><p>&nbsp;</p><p><span>41min  重新拉一次镜像</span></p><h4 id='靶场-2'><span>靶场</span></h4><p><span>48min    docker本身漏洞</span></p><p><span>先用docker搭建一个shiro的靶场，模拟红队拿下并植入哥斯拉的内存马，上传后门flag：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111171454566.png" referrerpolicy="no-referrer" alt="image-20250111171454566"></p><p><span>50min  模拟红队入侵后蓝队排查。      翻车</span></p><p><span>然后模拟蓝队排查，前面怎么发现被植入后门就不演示了，可以用docker监听网络的工具进行发现异常连接。</span></p><p><span>下来就是排查：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172034549.png" referrerpolicy="no-referrer" alt="image-20250111172034549"></p><p>&nbsp;</p><p><span>1h04min  有一个检查当前docker环境是否有漏洞的项目。第一次项目不用弄了，ubuntu不合适，适合第二个格式.deb文件。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172508548.png" referrerpolicy="no-referrer" alt="image-20250111172508548"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172737385.png" referrerpolicy="no-referrer" alt="image-20250111172737385"></p><p><span>扫描出来的结果可以用来写一下修复建议等。</span></p><p>&nbsp;</p><p><span>1h12min  近源------宏</span></p><p><span>近源最后也是得上线，就看好上线的通讯就行。 </span></p><p><a href='https://mp.weixin.qq.com/s/WBFTtAuyC7PauFZbNBja5Q' target='_blank' class='url'>https://mp.weixin.qq.com/s/WBFTtAuyC7PauFZbNBja5Q</a></p><h1 id='220内存马查杀'><span>220：内存马查杀</span></h1><p><span>java中比较多，</span></p><p><span>5min   配环境 </span></p><p><span>8min  植入哥斯拉内存马，无文件马。用脚本jsp，可以查看当前目录下是否有内存马，也只能用于一些常见传统内存马。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115111126856.png" referrerpolicy="no-referrer" alt="image-20250115111126856"></p><p><span>这里植入内存马要注意：1、植入的是在进入的后门路径下 </span><span>	</span><span>2、密码要对应</span><span>	</span><span>3、连接进来的后门什么类型java，内存马也是对应的java类型</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115111257532.png" referrerpolicy="no-referrer" alt="image-20250115111257532"></p><p><span>自然，在对应目录下只能找到常规的后门文件，没有内存马的文件。</span></p><h5 id='1---jsp脚本'><span>1   .jsp脚本</span></h5><p><span>第一个查杀内存马项目，tomcat-memshell-scanner.jsp，将这个脚本放到可能存在内存马的目录下，直接访问就可以检测出来是否存在内存马。找到添加的server  和filter两个类型内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115112302534.png" referrerpolicy="no-referrer" alt="image-20250115112302534"></p><p><span>但是这个脚本比较局限，一般适用于常见的内存马()和常见的框架（tomcat）：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115112512226.png" referrerpolicy="no-referrer" alt="image-20250115112512226"></p><p><span>然后这个可以把内存马dump下来分析，或者直接kill掉：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113209738.png" referrerpolicy="no-referrer" alt="image-20250115113209738"></p><h5 id='2---arthas'><span>2   arthas</span></h5><p><span>17min  另一个项目，是用来监控内存的。我们可以用它来检测内存马。20min  运行jar打开项目，失败可能是因为java版本问题。.\arthas-boot.jar</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113708649.png" referrerpolicy="no-referrer" alt="image-20250115113708649"></p><p><span>启动jar包后会自动检测当前环境里运行的java环境，然后选择你当前需要他进行检测的java环境。</span></p><p><span>1、启动jar包，发现了2个java进程，1是哥斯拉，2是tomcat，</span><span>	</span><span>2、那我们要检测的是tomcat下是否有内存马植入，选择2  </span><span>	</span><span>3、报错，java版本错误</span><span>	</span><span>4、更换成1.8_291重启启动成功：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113958531.png" referrerpolicy="no-referrer" alt="image-20250115113958531"></p><p><span>查看url路由，（找Servlet内存马），因为正常来说，路由有的，你目录下也是有对应的路径的，但是内存马就是有路由，但是目录下没有对应文件。但是这里好像只能识别出servlet型的</span></p><p><span>一些简单使用的命令。</span></p><p><span>这里用查看URL路由，发现了servlet型的内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115150650294.png" referrerpolicy="no-referrer" alt="image-20250115150650294"></p><p><span>28min 利用sc命令，查看JVM 已加载的类信息，反编译指定已加载类的源码或者直接下载下来分析。</span></p><p><span>sc查看JVM 已加载的类信息，然后配合经验或者刚才的脚本来找到哪个可能是内存马调用的java类、通过搜索发现里面的node.BaseJsonNode不是系统自带的，怀疑可能是：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115163035177.png" referrerpolicy="no-referrer" alt="image-20250115163035177"></p><p><span>jad反编译指定已加载类的源码、进一步分析：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175326646.png" referrerpolicy="no-referrer" alt="image-20250115175326646"></p><p><span>dump下来目标class文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175555471.png" referrerpolicy="no-referrer" alt="image-20250115175555471"></p><p><span>打开class（idea或者jadx-gui）打开发现一些哥斯拉的特征。什么连接方式，AES_BASE64、连接密码等这些信息：或者就直接复制粘过去让gpt分析一下：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175837342.png" referrerpolicy="no-referrer" alt="image-20250115175837342"></p><p><span>41min  找servlet ，拿到class文件后分析：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115181010544.png" referrerpolicy="no-referrer" alt="image-20250115181010544"></p><p><span>下来还可以将dump下来的class文件打开，保存到java格式、上传微步分析：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115181657127.png" referrerpolicy="no-referrer" alt="image-20250115181657127"></p><p><span>51min  许少的工具，查找内存马工具</span></p><p><span>但是这些还是有局限，只能查杀部分类型的内存马。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115184540712.png" referrerpolicy="no-referrer" alt="image-20250115184540712"></p><p><span>1h03min  还可以通过日志发现：当本地路径中没有这个文件，但是你的访问路径（攻击者访问）有这个文件，而且的状态是200的post请求，那么就怀疑这里是不是有内存马。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115192146605.png" referrerpolicy="no-referrer" alt="image-20250115192146605"></p><p><a href='https://github.com/Getshell/Mshell' target='_blank' class='url'>https://github.com/Getshell/Mshell</a></p><h1 id='221内存马2'><span>221：内存马2</span></h1><p><span>9min  listener 框架的后门      哥斯拉不支持linstener的内存马，可以用脚本或者工具植入。查杀还是用项目arthas-bin，就是需要将查找语法自己写。</span></p><h5 id='listener'><span>listener</span></h5><p><span>使用jar包工具生成listener内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116110616219.png" referrerpolicy="no-referrer" alt="image-20250116110616219"></p><p><span>然后访问就植入了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116110922433.png" referrerpolicy="no-referrer" alt="image-20250116110922433"></p><p><span>listen.jsp内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116111137313.png" referrerpolicy="no-referrer" alt="image-20250116111137313"></p><p><span>然后查杀就可以用上面的脚本，也可以用其他几个都行。</span></p><p><span>中间件内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114604021.png" referrerpolicy="no-referrer" alt="image-20250116114604021"></p><p><span>25min  </span></p><h5 id='tomcat-valve'><span>tomcat valve        </span></h5><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112427486.png" referrerpolicy="no-referrer" alt="image-20250116112427486"></p><p><span>中间的路径都行asd?</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112541712.png" referrerpolicy="no-referrer" alt="image-20250116112541712"></p><p><span>查杀：</span></p><p><span>gui和arthas都可以查杀、jsp脚本就在这儿用不了了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112805330.png" referrerpolicy="no-referrer" alt="image-20250116112805330"></p><p><span>这里还有一个项目，也可以查杀，但是不如arthas，因为他是将所有结果放到txt里让你自己分析，没有自动匹配：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116113306386.png" referrerpolicy="no-referrer" alt="image-20250116113306386"></p><h5 id='spring'><span>spring</span></h5><p><span>框架型内存马：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114548480.png" referrerpolicy="no-referrer" alt="image-20250116114548480"></p><p><span>35min  spring boot  框架       先不考虑如何植入的，是用代码进行植入的。访问对应地址就会触发内存马。----小翻车  jar包有问题，用idea启动环境。41min              gui是查不出来这类内存马的，用cop或者arthas两个项目进行查杀，推荐还是用alibaba的arthas进行查杀</span></p><p><span>至于这里具有为什么访问那个路径就植入内存马（spring boot 型），为什么访问参数是cmwpzz，那都是得看源码，他是放到源码了，然后给你打包jar包让你直接运行了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114133081.png" referrerpolicy="no-referrer" alt="image-20250116114133081"></p><p><span>这里还是推荐arthas，但是缺点也很明显，就是查找语法你得自己找，找到正确的，然后那个cop的jar包也可以找到， 只是需要自己找。</span></p><p><span>52min  使用arthas进行语法搜索，因为你是作为蓝队，那么是自己当前的环境肯定是知道的，为spingboot框架的，那spingboot根据资料，就那3种类型：SpringController、SpringInterceptor、Spring Webflux         那就根据这个类型进行语法筛选：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116115543853.png" referrerpolicy="no-referrer" alt="image-20250116115543853"></p><p><span>SpringInterceptor：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116115657185.png" referrerpolicy="no-referrer" alt="image-20250116115657185"></p><p><span>找到后在jar包中将对应的class文件删除（删除内存马）</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116152315063.png" referrerpolicy="no-referrer" alt="image-20250116152315063"></p><h5 id='webflux'><span>webflux </span></h5><p><span>1h04min webflux        ，内存马已经植入了（运行网页时候就植入了），什么路径都可以进入：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116152558425.png" referrerpolicy="no-referrer" alt="image-20250116152558425"></p><p><span>内存马也是写到里面的class文件，这个查杀时候，需要用到关键字筛选memshell shell os  runtime都是一些java代码rce的关键字，需要区分大小写：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116153320803.png" referrerpolicy="no-referrer" alt="image-20250116153320803"></p><p>&nbsp;</p><p><span>这里查杀时候，主要还是查找语法，有的基于内存马固定后缀，名字，文件中的一些可疑关键字来查找。</span></p><h1 id='222rookit'><span>222：rookit</span></h1><p><span>维权技术：web：内存马 webshell     服务器：Rookit技术C2后门</span></p><p><span>一款用来分析，逆向的工具箱：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111006861.png" referrerpolicy="no-referrer" alt="image-20250117111006861"></p><p><span>13min   上线msf ，查杀c2后门。直接用一些工具就可以发现c2后门：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111427890.png" referrerpolicy="no-referrer" alt="image-20250117111427890"></p><p>&nbsp;</p><p><span>18min 所以需要对c2后门进行处理，就是rookit技术。可以隐藏网络，进程，位置。</span></p><p><span>   蓝队检测rookit技术，需要知道攻击者用的Rookit是什么“家族”。</span></p><p><span>使用r77-rookite工具隐藏后门，可以让一般的进程工具找不到，但是火绒剑还是能看到：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111945171.png" referrerpolicy="no-referrer" alt="image-20250117111945171"></p><p><span>还可以加远程端口实现隐藏，文件开头为$77开头实现隐藏文件。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117112506410.png" referrerpolicy="no-referrer" alt="image-20250117112506410"></p><p><span>这个r77只是rootkit的一个家族，一个类型。rootkit有许多家族。如果不知道rootkit技术，是比较难排查出来并解开的，就像勒索解密一样。</span></p><p><span>就如果你（蓝队）知道攻击者用的是r77技术实现的，你就可以找到对应位置或者自己也下一个相同版本的点击unintall卸载掉，那就解决了rootkit。不过这种可能性低。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117112918659.png" referrerpolicy="no-referrer" alt="image-20250117112918659"></p><h5 id='unhide'><span>unhide</span></h5><p><span>28min  一个项目，可以发现被隐藏的进程端口。开源的，所以功能也受限，有些商业产品可以很好的检测rootkit技术 </span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117113735079.png" referrerpolicy="no-referrer" alt="image-20250117113735079"></p><p><span>找到本地与外面通讯的被隐藏的端口：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117114120721.png" referrerpolicy="no-referrer" alt="image-20250117114120721"></p><p>&nbsp;</p><p><span>35min   封ip          下来就是封ip，封远程端口：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117114923404.png" referrerpolicy="no-referrer" alt="image-20250117114923404"></p><p><span>这里一般都是封远程ip端口，因为本地的端口是会变化的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117115033148.png" referrerpolicy="no-referrer" alt="image-20250117115033148"></p><p><span>42min  演示msf控制，用unhide  工具来发现rookit隐藏的进程文件。开源的，商业不知道</span></p><p><a href='https://mp.weixin.qq.com/s/LnqArTrAytMKtitGvplNug' target='_blank' class='url'>https://mp.weixin.qq.com/s/LnqArTrAytMKtitGvplNug</a></p><p><span>这款工具可以查找隐藏的进程，也是有限，毕竟是开源的。</span></p><h5 id='rkhunter'><span>rkhunter </span></h5><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117154613772.png" referrerpolicy="no-referrer" alt="image-20250117154613772"></p><p><span>1h      火绒剑是可以检测到隐藏的进程，网络隐藏是检测不到的</span></p><h5 id='clamav'><span>clamav </span></h5><p><span>1h11min  clamav         linux上的杀毒，但查杀rookit基本不可能，常规木马可以发现。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117164821365.png" referrerpolicy="no-referrer" alt="image-20250117164821365"></p><p><span>最后还是clamav   unhide比较好点</span></p><h1 id='223小工具日志'><span>223：小工具(日志)</span></h1><p><span>混子工具</span></p><p><span>日志：提权---------查看--------分析</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>日志自动提取</span></p><h4 id='采集'><span>采集：</span></h4><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118155845994.png" referrerpolicy="no-referrer" alt="image-20250118155845994"></p><p><span>Logkit</span></p><p><span>15min   七牛Logkit</span></p><p><span>启动：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118160320955.png" referrerpolicy="no-referrer" alt="image-20250118160320955"></p><p><span>打开对应ip+port</span>
<img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118160344664.png" referrerpolicy="no-referrer" alt="image-20250118160344664"></p><p>&nbsp;</p><p><span>运行后采集的日志保存到服务器本地上（192.168.139.143）路径你指定的，然后也自带有分析日志的工具。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173116762.png" referrerpolicy="no-referrer" alt="image-20250118173116762"></p><p><span>20min  日志提权分析工具、只能对系统上面进行分析。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118171733219.png" referrerpolicy="no-referrer" alt="image-20250118171733219"></p><p><span>分析查看：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172252326.png" referrerpolicy="no-referrer" alt="image-20250118172252326"></p><p>&nbsp;</p><p><span>日志自动查看</span></p><p><span>24min  LastActivityView 工具。查看器，看你在你电脑上干什么了、登录、删除、打开软件等操作。能动态的看用户。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172424843.png" referrerpolicy="no-referrer" alt="image-20250118172424843"></p><p><span>26min Fulleventlogview 日志事件查看器</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172555446.png" referrerpolicy="no-referrer" alt="image-20250118172555446"></p><p>&nbsp;</p><p>&nbsp;</p><h4 id='web日志查看'><span>Web日志查看</span></h4><p><span>自动分析：</span></p><p><span>30min  360星图     也只支持一些常规的：.net  .php 。改配置文件，指定需要分析的日志文件。</span></p><p><span>36min  可惜不支持java的</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173506300.png" referrerpolicy="no-referrer" alt="image-20250118173506300"></p><p><span>start.bat：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173611659.png" referrerpolicy="no-referrer" alt="image-20250118173611659"></p><p><span>40min GoAccess（任何自定义日志格式字符串，安全涉及少）不是针对安全进行分析的，所以不太适用。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117174645886.png" referrerpolicy="no-referrer" alt="image-20250117174645886"></p><p>&nbsp;</p><p><span>内网分析：</span></p><p><span>48min  wincheck_log</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118174141621.png" referrerpolicy="no-referrer" alt="image-20250118174141621"></p><p><span>55 min  chainsaw    使用简单。自己的规则和语法进行分析日志。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118183136966.png" referrerpolicy="no-referrer" alt="image-20250118183136966"></p><p><span>分析结果：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118183503180.png" referrerpolicy="no-referrer" alt="image-20250118183503180"></p><p><span>59min  较难搭建：比较占内存。LogonTracer       上传日志后会自动分析，然后找日志中的一些可以操作。---------翻车 1h18min    xd视频演示：</span></p><p><span>获取的日志上传分析：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184052255.png" referrerpolicy="no-referrer" alt="image-20250118184052255"></p><p><span>分析结果：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184608628.png" referrerpolicy="no-referrer" alt="image-20250118184608628"></p><p>&nbsp;</p><h4 id='linux-3'><span>linux</span></h4><p><span>1h19min  linux一些日志检测、大部分为批量检测：</span></p><p><a href='https://github.com/grayddq/GScan' target='_blank' class='url'>https://github.com/grayddq/GScan</a></p><p><a href='https://github.com/enomothem/Whoamifuck' target='_blank' class='url'>https://github.com/enomothem/Whoamifuck</a><span>        好用点</span></p><p><a href='https://github.com/Ashro-one/Ashro_linux' target='_blank' class='url'>https://github.com/Ashro-one/Ashro_linux</a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184444886.png" referrerpolicy="no-referrer" alt="image-20250118184444886"></p><p><span>apt-hunter</span></p><p>&nbsp;</p><p><span>最后还是得看自己分析，自己写一些规则来分析，特征分析，yaml语法。</span></p><h1 id='224elk'><span>224：ELK</span></h1><p><span>适用的是数据较大的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117195809448.png" referrerpolicy="no-referrer" alt="image-20250117195809448"></p><p><span>5min  环境配置</span></p><p><span>搭建：Docker搭建。</span></p><p><span>12min  成功搭建，进入查看部署。三种模式：上传文件，特定分析，代理加入。上传日志---上传文件。在自己的主机上配置后，主机就会将自己日志发送到平台上分析----代理加入。</span></p><p><span>里面有许多常见的系统，框架日志。</span></p><p><span>上传文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118191350816.png" referrerpolicy="no-referrer" alt="image-20250118191350816"></p><p><span>分析结果，还可以用一些语法进行查找：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118191833247.png" referrerpolicy="no-referrer" alt="image-20250118191833247"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192111561.png" referrerpolicy="no-referrer" alt="image-20250118192111561"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192202583.png" referrerpolicy="no-referrer" alt="image-20250118192202583"></p><p><span>23min  将目前系统日志上传上去进行分析。找到对应系统---Linux:</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192509733.png" referrerpolicy="no-referrer" alt="image-20250118192509733"></p><p><span>开始配置：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193111334.png" referrerpolicy="no-referrer" alt="image-20250118193111334"></p><p><span>配置后就可以看服务器/主机上面的日志，并且分析。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193543971.png" referrerpolicy="no-referrer" alt="image-20250118193543971"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193643652.png" referrerpolicy="no-referrer" alt="image-20250118193643652"></p><h4 id='yara'><span>yara</span></h4><p><span> 38min  yara-----VT下的一个产品</span></p><p><span>里面靠规则库查杀的，有的规则需要付费。</span></p><p><span>47min yama使用指定规则对目录进行扫描 。yar规则，这里面的自带库是比较老的，需要自己写或者网上找。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118194950982.png" referrerpolicy="no-referrer" alt="image-20250118194950982"></p><p><span>可见用的yar规则是比较老的，连目录里面的哥斯拉后门都没有识别出来，还可以识别里面用的什么加密算法：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118195331947.png" referrerpolicy="no-referrer" alt="image-20250118195331947"></p><p><a href='https://mp.weixin.qq.com/s/Ng8My7P3yIvDtEriacrZYw'><span>YARA规则与办公安全：高效检测策略 (qq.com)</span></a></p><p><span>58min  自写yar规则。 规则好写，但是目标的强特征难找，要找的样本特征难。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119005525373.png" referrerpolicy="no-referrer" alt="image-20250119005525373"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119005615250.png" referrerpolicy="no-referrer" alt="image-20250119005615250"></p><p>&nbsp;</p><p><span>1h08 ------- 1h13  编写规则识别内存马。先找内存马的特征。（这里哥斯拉一直连接不上，连接密码错了，是pass不是password）；</span></p><p><span>找到tomcat进程，然后右键转为存储文件.dmp       java内存数据.dmp文件</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119110132401.png" referrerpolicy="no-referrer" alt="image-20250119110132401"></p><p><span>植入内存马后，用010打开.dmp文件，发现里面存在特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119110503159.png" referrerpolicy="no-referrer" alt="image-20250119110503159"></p><p><span>编写内存马规则，几个类作为特征。内存马没有文件，所以这里识别时候是用进程代替的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119111601251.png" referrerpolicy="no-referrer" alt="image-20250119111601251"></p><h1 id='225设备部署'><span>225：设备部署</span></h1><p><span>基于主机的入侵检测系统（HIDS）qax 的 ngsoc         H--host</span></p><p><span>基于网络的入侵检测系统（NIDS)</span><span>				</span><span>N--net</span></p><h4 id='nids'><span>NIDS</span></h4><p>&nbsp;</p><p><span>6min  NIDS-Snort</span></p><h6 id='snort'><span>snort</span></h6><p><span>先启动snort开始监听网卡，写icmp规则（可以检测如果有icmp请求，就可以记录下来）rules文件，在.conf文件中将写好的icmp规则导入进来，然后ping主 机。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119230422225.png" referrerpolicy="no-referrer" alt="image-20250119230422225"></p><p><span>查看成功收到，监听到icmp的数据：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231218764.png" referrerpolicy="no-referrer" alt="image-20250119231218764"></p><p><span>监听ICMP协议。</span></p><p><span>然后将规则文件改一下名字：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231329533.png" referrerpolicy="no-referrer" alt="image-20250119231329533"></p><p><span>16min  规则        官网也有</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231718613.png" referrerpolicy="no-referrer" alt="image-20250119231718613"></p><p><span>20min  msf生成linux后门上线，正向反向都有，然后分别配置规则用来监听。</span></p><p><span>我连接外部ip的7799          2、对方端口随机，连接我的（受害机）7799端口</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119232159103.png" referrerpolicy="no-referrer" alt="image-20250119232159103"></p><p>&nbsp;</p><p><span>27min  配置sql注入规则检测，检测数据包中是否有or 1=1这些字符。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119232541454.png" referrerpolicy="no-referrer" alt="image-20250119232541454"></p><p><span>32min  sql注入。使用sqlmap扫描目标，然后配好sql注入的snort规则，查看日志流量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119233107903.png" referrerpolicy="no-referrer" alt="image-20250119233107903"></p><p><span>然后开扫、查看日志流量情况：</span></p><p><span>alert http any any -&gt; any any (msg:&quot;xiaodisec find sqlmap tools attack&quot;; flow:to_server; content:&quot;User-Agent: sqlmap&quot;; http_header; sid:1000016; rev:1;)改了一下sql检测规则：</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h6 id='suricata'><span>suricata</span></h6><p><span>46min   suricata安装                                 </span></p><p><span>57min  开始演示、suricata这个规则网上较多。 </span><a href='https://mp.weixin.qq.com/s/VjWPSVzP0whafH-oCmmvLA'><span>入侵检测之流量分析--suricata规则库来源梳理 (qq.com)</span></a></p><p><span>将检测冰蝎的规则放入：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120112048290.png" referrerpolicy="no-referrer" alt="image-20250120112048290"></p><p><span>监听：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120112134773.png" referrerpolicy="no-referrer" alt="image-20250120112134773"></p><p><span>前面的冰蝎连接web就不演示了：</span></p><p><span>捕获冰蝎数据：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120111349984.png" referrerpolicy="no-referrer" alt="image-20250120111349984"></p><p>&nbsp;</p><p><span>1h12 min </span></p><p><span>使用goby扫，完了后监听看日志：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120113430568.png" referrerpolicy="no-referrer" alt="image-20250120113430568"></p><p><span>           </span></p><p><span>通达oa，当攻击者尝试使用oa攻击工具进行攻击时，我们可以用使用的规则来探测到攻击者的攻击：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120114456656.png" referrerpolicy="no-referrer" alt="image-20250120114456656"></p><p><span>sqlmap</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120115208087.png" referrerpolicy="no-referrer" alt="image-20250120115208087"></p><p><span>cs：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120115359663.png" referrerpolicy="no-referrer" alt="image-20250120115359663"></p><h1 id='226设备部署'><span>226:设备部署</span></h1><h4 id='hids--后续购买服务器进行复现'><span>HIDS  后续购买服务器进行复现。</span></h4><p><span>这是攻击已经在主机中，才开始检测的。</span></p><p><span>Elkeid-----字节的。</span></p><p><span>7min 这里演示是docker搭建的。</span></p><p><span>10min 设备搭建在服务端上，然后客户端作为被监控对象。上线主机。</span></p><p><span>这里开始进入查看客户端报错，换google浏览器后重新进入平台查看。</span></p><p><span>22min 放一个cs和webshell后门到客户端上让设备进行基线检测，看能不能检测出来。</span></p><p><span>26min  进行爆破客户端，查看爆破的告警信息</span></p><p>&nbsp;</p><p><span>34min Wazuh     外国的</span></p><p><span>可以配合ELK，自带日志分析功能。</span></p><p><span>37min  演示上线，连接客户机。</span></p><p><span>自带att&amp;ck     红队攻击模型 </span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>54min 搭建elk：</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='227设备部署'><span>227：设备部署</span></h1><p><span>堡垒机，蜜罐</span></p><p><span>ct------长亭</span></p><p><span>WAF-------雷池--ct</span></p><p><span>8min  演示搭建</span></p><p><span>23min 演示wos攻击后的告警。</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span>35min  搭建蜜罐。爆破蜜罐也可以监测到访问。</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span>54min 堡垒机-------jumpserver</span></p><p><span>堡垒机：帮助企业以更安全的方式管控和登录所有类型的资产</span></p><p><span>1h07min 堡垒机主页面。他不是保护你的，反而还需要你的保护，因为被拿下后整个账户资产就被拿到了。</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='228流量分析'><span>228：流量分析</span></h1><p><span>webshell工具。</span></p><p><span>菜刀基本已经淘汰，没有开源，魔改较少。</span><a href='https://mp.weixin.qq.com/s/SjUMoY6EafQzAb3RNWNkpg' target='_blank' class='url'>https://mp.weixin.qq.com/s/SjUMoY6EafQzAb3RNWNkpg</a></p><p><span>bp只能抓到http和https，</span></p><h5 id='蚁剑'><span>蚁剑：</span></h5><p><span>10min  特征点：1、UA头       2、Post提交       3、传参的值base64去掉前面2个字符后可以成功解码。正常都是要么解不了，要么乱码 （这么做可以就是防止被解码发现）         4、@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122111634305.png" referrerpolicy="no-referrer" alt="image-20250122111634305"></p><p><span>配好代理，生成后门，连接：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122174847934.png" referrerpolicy="no-referrer" alt="image-20250122174847934"></p><p><span>webshell一般都是Post提交，因为数据包多，get是传不上这么多的。连接上后做一些操作，观察数据包：</span></p><p><span>post  我这里ua头好像不是antSword/v2.1，也不知为啥。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122180811228.png" referrerpolicy="no-referrer" alt="image-20250122180811228"></p><p><span>Base64编码提交的数据（去掉前2位），这也是特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122181429466.png" referrerpolicy="no-referrer" alt="image-20250122181429466"></p><p><span>当连接时候用的为默认时候，这里数据就是ini开始的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122181941604.png" referrerpolicy="no-referrer" alt="image-20250122181941604"></p><h5 id='冰蝎'><span>冰蝎：</span></h5><p><span>20min   UA头，有时候会变，但是都是在他的一个库里面进行随机换。</span><span>	</span></p><p><span>数据加密方式可能为aes，这种解密是需要密钥或者偏移量来解密。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122113008980.png" referrerpolicy="no-referrer" alt="image-20250122113008980"></p><p><span>特征1、2、3</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122182533862.png" referrerpolicy="no-referrer" alt="image-20250122182533862"></p><p><span>他的数据包是aes加密的，如果不知道加密密钥(webshell连接密码)，那就解不开数据内容。referer也算个特征，冰蝎是有referer：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122183247916.png" referrerpolicy="no-referrer" alt="image-20250122183247916"></p><p>&nbsp;</p><h5 id='天蝎'><span>天蝎：</span></h5><p><span>37min       冰蝎的延深</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184217903.png" referrerpolicy="no-referrer" alt="image-20250122184217903"></p><p><span>3个特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184323627.png" referrerpolicy="no-referrer" alt="image-20250122184323627"></p><p><span>与冰蝎相比，数据包的加密更换，回显包的加密也更改了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184558521.png" referrerpolicy="no-referrer" alt="image-20250122184558521"></p><h5 id='哥斯拉'><span>哥斯拉</span></h5><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191422806.png" referrerpolicy="no-referrer" alt="image-20250122191422806"></p><p><span>代理还让我配半天，有两个地方需要改：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122190102797.png" referrerpolicy="no-referrer" alt="image-20250122190102797"></p><p><span> 44min   连接成功会发送3个数据包，失败会发送2个数据包。</span></p><p><span>成功连接点击success后第3个数据包才出来：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191130097.png" referrerpolicy="no-referrer" alt="image-20250122191130097"></p><p><span>特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191834352.png" referrerpolicy="no-referrer" alt="image-20250122191834352"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191950007.png" referrerpolicy="no-referrer" alt="image-20250122191950007"></p><p><span>55min  蓝队分析工具箱，解密webshell工具的数据包------主要还是要知道密钥</span></p><p><span>这里使用的是默认密钥：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122195912572.png" referrerpolicy="no-referrer" alt="image-20250122195912572"></p><p><span>解密返回包，也是判断的方法之一：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122200018432.png" referrerpolicy="no-referrer" alt="image-20250122200018432"></p><h4 id='题型'><span>题型：</span></h4><p><span>1h05min  ctf题型：</span></p><p><span>目的、给了一个wireshark抓包的数据包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233720077.png" referrerpolicy="no-referrer" alt="image-20250122233720077"></p><p><span>首先说了是冰蝎的流量包，那就是http的post请求，先缩小范围：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233754663.png" referrerpolicy="no-referrer" alt="image-20250122233754663"></p><p><span>下来需要找ip，那就利用的是冰蝎连接时候会加载phpinfo信息（初始化），这里面就有ip等信息，就需要找这个的流量包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234308281.png" referrerpolicy="no-referrer" alt="image-20250122234308281"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233948720.png" referrerpolicy="no-referrer" alt="image-20250122233948720"></p><p><span>将上面加密后的继续解密，得到phpinfo的html代码：</span></p><p><span> </span><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234136214.png" referrerpolicy="no-referrer" alt="image-20250122234136214"></p><p>&nbsp;</p><p><span>1h32min 第二个   蚁剑</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234745882.png" referrerpolicy="no-referrer" alt="image-20250122234745882"></p><p><span>还是找，完了解密时候就注意删前2个字符后再解密。</span></p><p>&nbsp;</p><h1 id='229流量分析'><span>229：流量分析</span></h1><p><span>c2远控</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124145252300.png" referrerpolicy="no-referrer" alt="image-20250124145252300"></p><p><span>Vshell在今年24hw比较流行</span></p><h4 id='cs'><span>cs：</span></h4><p><span>8min    http</span></p><p><span>将数据包导出来用脚本工具解析，成功后就可以确认为cs后门。下面是cs--http的3个特征</span></p><p><span>http后门上线，首先就是固定的数据包头：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124180959269.png" referrerpolicy="no-referrer" alt="image-20250124180959269"></p><p><span>还有就是checksum8算法，64位后门对应93、32位的后门对应结果为92：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124181231154.png" referrerpolicy="no-referrer" alt="image-20250124181231154"></p><p><span>还可以对数据包进行解析，成功解析cs的心跳包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124181832077.png" referrerpolicy="no-referrer" alt="image-20250124181832077"></p><p>&nbsp;</p><p><span>20min https  是经过加密的，数据包内容是加密的。 看TLS协议的包，然后找两个hello的包。 ja3和ja3s 的值，每个cs版本里的都是固定的，版本不同值不同。这里都是通过对比ja3和ja3s 的值来判断是否为恶意软件。还有一个是其默认引用的证书特征。</span></p><p><span>抓https后门上线的数据包，找2个hello：</span></p><p><span>当然每一个cs版本不同，对应的ja3和ja3s的值不同</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124183012736.png" referrerpolicy="no-referrer" alt="image-20250124183012736"></p><p><span>将数据包导出https.pcapng。然后用脚本工具可以找到里面的ja3，那么av查杀也是这样找到对应的ja3进而锁定是cs后门。就是将ja3 ja3s值整合一起到库里来检测。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124185827072.png" referrerpolicy="no-referrer" alt="image-20250124185827072"></p><p>&nbsp;</p><h4 id='msf'><span>msf</span></h4><p><span>42min  -------- 51min   msf的shell数据包是明文传输：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124194900934.png" referrerpolicy="no-referrer" alt="image-20250124194900934"></p><p>&nbsp;</p><p><span>52min  msf-http</span><span>	</span><span>特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124201853307.png" referrerpolicy="no-referrer" alt="image-20250124201853307"></p><p><span>有固定数据包头，get后的路径是随机的，长度也随机：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124201926481.png" referrerpolicy="no-referrer" alt="image-20250124201926481"></p><p><span>混淆上面的MZ文件头：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124202016333.png" referrerpolicy="no-referrer" alt="image-20250124202016333"></p><p><span>57min  msf --https              自然，这里的ja3 ja3s也和msf版本有关。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124221041333.png" referrerpolicy="no-referrer" alt="image-20250124221041333"></p><h4 id='sliver'><span>sliver</span></h4><p><a href='https://mp.weixin.qq.com/s/G3ggCKxQy0nOqRuTUPHfiQ'><span>新型渗透工具Sliver的流量特征分析与检测 (qq.com)</span></a></p><p><span>1h04min </span><span>	</span><span>sliver-http</span></p><p><a href='https://forum.butian.net/share/2243'><span>奇安信攻防社区-红队工具研究篇 - Sliver C2 (butian.net)</span></a><span>	</span><span>sliver使用</span></p><p><span>先在这儿把自己的ip填进去门后面还有个log文件存储地址也需要改一下：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127123949034.png" referrerpolicy="no-referrer" alt="image-20250127123949034"></p><p><span>先生成windows后门-http的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124222142266.png" referrerpolicy="no-referrer" alt="image-20250124222142266"></p><p><span>上线：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124222651695.png" referrerpolicy="no-referrer" alt="image-20250124222651695"></p><p><span>捕获流量特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124223615432.png" referrerpolicy="no-referrer" alt="image-20250124223615432"></p><p><span>可以看到在sliver源码cookie库和路径库中都有对应的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124224127356.png" referrerpolicy="no-referrer" alt="image-20250124224127356"></p><p><span>根据路径文件名，后缀，cookie这些信息到源码里面的数组随机组合配合分析排查：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124231100390.png" referrerpolicy="no-referrer" alt="image-20250124231100390"></p><p><span>然后就通过这几个条件来满足sliver--http的规则</span></p><p><span>1h19min sliver-https</span></p><p><span>生成https的后门，监听，上线：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232205493.png" referrerpolicy="no-referrer" alt="image-20250124232205493"></p><p><span>将抓到的流量包还是用工具找出ja3和ja3s</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124231934786.png" referrerpolicy="no-referrer" alt="image-20250124231934786"></p><p><span>和文章</span><a href='https://mp.weixin.qq.com/s/G3ggCKxQy0nOqRuTUPHfiQ'><span>新型渗透工具Sliver的流量特征分析与检测 (qq.com)</span></a><span>分析出来的值一样：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232053409.png" referrerpolicy="no-referrer" alt="image-20250124232053409"></p><p><span>找到这些流量特征后就直接写到自己的edr中：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232426856.png" referrerpolicy="no-referrer" alt="image-20250124232426856"></p><p>&nbsp;</p><p><span>1h27min  工具</span></p><h1 id='230内网隧道'><span>230：内网隧道</span></h1><h4 id='frp'><span>frp：</span></h4><p><span>7min   也是分版本，先是0.33版本的，流量包内容中有一些固定特征。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125175833688.png" referrerpolicy="no-referrer" alt="image-20250125175833688"></p><p><span>启动frp，建立隧道：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181210107.png" referrerpolicy="no-referrer" alt="image-20250125181210107"></p><p><span>然后捕获到建立通讯时候的流量包、捕获特征version.....：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181448111.png" referrerpolicy="no-referrer" alt="image-20250125181448111"></p><p><span>其中timestamp就是时间戳:</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125182126636.png" referrerpolicy="no-referrer" alt="image-20250125182126636"></p><p><span>剩下两个特征包在下面：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181733510.png" referrerpolicy="no-referrer" alt="image-20250125181733510"></p><p><img src="F:\gayxiaodi\develop\16blue_team\230-蓝队技能-流量分析篇&amp;隧道代理&amp;工具特征&amp;分析项目等\frp.png" referrerpolicy="no-referrer" alt="frp"></p><h6 id='044'><span>0.44</span></h6><p><span>15min 0.44版本  比0.3版本的流量内容特征少一些  </span></p><p><span>不难看出，这里面的version比0.33少了：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125191054062.png" referrerpolicy="no-referrer" alt="image-20250125191054062"></p><h6 id='06'><span>0.6</span></h6><p><span>0.6版本，ssl协议</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125200552902.png" referrerpolicy="no-referrer" alt="image-20250125200552902"></p><p>&nbsp;</p><p><span>给配置文件ini中添加tls_enable 或token能实现tls加密。</span></p><p><span>就是低版本是没有tls加密协议的，所以数据包内容中可以看到固定特征，高版本是自带的，自己已经加密了。所以流量数据包内容是看不到特征的。但这些都可以配。 </span></p><p><span>0.33版本的frp配置tls加密协议：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201211710.png" referrerpolicy="no-referrer" alt="image-20250125201211710"></p><p><span>捕获数据包都是经过加密处理的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201333190.png" referrerpolicy="no-referrer" alt="image-20250125201333190"></p><p><span>32min 那么如果低版本配置了tls加密，或者高版本自带tls加密、该怎么找特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201530830.png" referrerpolicy="no-referrer" alt="image-20250125201530830"></p><p><a href='https://mp.weixin.qq.com/s/APeSpvagBmnrJdjofzh1Yw'><span>内网代理和穿透工具的分析记录 (qq.com)</span></a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125202226243.png" referrerpolicy="no-referrer" alt="image-20250125202226243"></p><p><span>&quot;Gryphon&quot;协议前客户端携带&quot;0x17&quot;，这就是用了tls加密后frp的一个特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125202428102.png" referrerpolicy="no-referrer" alt="image-20250125202428102"></p><h4 id='nps'><span>nps</span></h4><p><span>41min  --------  54min --1h02min </span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125205530309.png" referrerpolicy="no-referrer" alt="image-20250125205530309"></p><p><span>先将nps搭建好，直接./nps就行，ip+8080就可以访问，然后创建好客户端</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211956392.png" referrerpolicy="no-referrer" alt="image-20250125211956392"></p><p>&nbsp;</p><p><span>http：</span></p><p><span>特征1：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125205723582.png" referrerpolicy="no-referrer" alt="image-20250125205723582"></p><p><span>特征2：认证成功：服务端向客户端发送sucs，客户端发送main，这里是在nps的源码中定义的，固定的，所以在其流量包中也会有对应的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125210340547.png" referrerpolicy="no-referrer" alt="image-20250125210340547"></p><p><span>特征3：当你建立socks或者tcp udp连接时，用这些流量通讯后有传输数据特征固定格式。隧道的特征：</span></p><p><span>产生传输流量，这儿的socks代理是服务器上的，所以自然配置地址也就是服务器的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211438681.png" referrerpolicy="no-referrer" alt="image-20250125211438681"></p><p><span>固定特征格式（注意这里需要先产生，也就是让其的socks或者tcp udp产生流量，才会有这个特征）：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211607218.png" referrerpolicy="no-referrer" alt="image-20250125211607218"></p><h4 id='neo-regeorg'><span>Neo-reGeorg</span></h4><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125225811935.png" referrerpolicy="no-referrer" alt="image-20250125225811935"></p><p><span>先设置密码生成后门，上传web服务器，再用工具连接就自动建立了socks5代理：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125230250966.png" referrerpolicy="no-referrer" alt="image-20250125230250966"></p><p><span>注意：这儿的socks代理是本地的，所以配置需要注意。还是用代理让本地socks代理访问网站产生通讯流量，用来找特征：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125230818391.png" referrerpolicy="no-referrer" alt="image-20250125230818391"></p><p>&nbsp;</p><p><span>踩坑，代理这里是下面这样配的，上面有个验证url，所以一直没有访问产生socks流量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231644016.png" referrerpolicy="no-referrer" alt="image-20250125231644016"></p><p><span>特征：html注释的字符串、固定的数据包格式和UA头：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231325146.png" referrerpolicy="no-referrer" alt="image-20250125231325146"></p><p><span>后面的post数据包和返回包：有cookie    还有加密编码后的字符串------这里是访问产生socks流量后才会产生的数据包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231935173.png" referrerpolicy="no-referrer" alt="image-20250125231935173"></p><p>&nbsp;</p><h4 id='venom'><span>venom：</span></h4><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125232630162.png" referrerpolicy="no-referrer" alt="image-20250125232630162"></p><p><span>1h21min  服务端启动，客户端连接：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125232602993.png" referrerpolicy="no-referrer" alt="image-20250125232602993"></p><p><span>捕获连接流量：数据包带有&quot;ABCDEFGH&quot;、&quot;VCMD&quot;</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125233135705.png" referrerpolicy="no-referrer" alt="image-20250125233135705"></p><p><span>venom的源码-----特征出处。协议数据分隔符、协议特征, 用于在端口重用时鉴别：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125233302897.png" referrerpolicy="no-referrer" alt="image-20250125233302897"></p><p><span>总结：最后分析特征就是从流量数据包中找到，从源码中分析：下来就是写规则，写防火墙，主要针对网络流量等进行拦截分析。</span></p><h1 id='231规则开发'><span>231：规则开发  </span></h1><h5 id='sliver-2'><span>sliver</span></h5><p><span>写规则：</span></p><p><span>4min sliver  生成后门上线。</span></p><p><span>生成两个后门 http和https，后面准备上线使用 suricata进行拦截。</span></p><p>&nbsp;</p><p><span>suricata安装windows，8min               </span></p><p><span>11min .rule文件说明。写一个http/https的规则文件用来检测sliver后门。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132024743.png" referrerpolicy="no-referrer" alt="image-20250127132024743"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132323185.png" referrerpolicy="no-referrer" alt="image-20250127132323185"></p><p><span>主要还是需要知道特征，然后自己能口述出给gpt，在稍微修改一下。</span></p><p><span>监测时候一种是添加到yaml文件中，还可以用命令符指定：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132812238.png" referrerpolicy="no-referrer" alt="image-20250127132812238"></p><p><span>然后上线sliver-http，并且开启suricata监听，查看fast.log文件，触发了rule规则文件里的js和php规则：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127143814342.png" referrerpolicy="no-referrer" alt="image-20250127143814342"></p><p><span>https的监测，对应的是ja3的hash：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127144415008.png" referrerpolicy="no-referrer" alt="image-20250127144415008"></p><h5 id='cs-2'><span>cs：</span></h5><p><span>32min  cs -----38min http</span></p><p><span>根据提交方式post 和路径固定特征写，再配合checksum8写规则。</span></p><p><span>先配置下文件，yaml文件中配置打开lua规则，然后将checksum8算法转换为lua语法文件，让suricata检测时候调用，依据这个算法进行规则匹配：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127152626856.png" referrerpolicy="no-referrer" alt="image-20250127152626856"></p><p><span>44min  checksum8算法是不能直接写到规则文件中的，调用lua检查uri是否符合checksum8规则。lua文件就是checksum8算法改过的，将java改成lua代码。</span></p><p><span>然后这里是配好的cs.rules规则，这个规则里就会检测checksum8的lua文件规则，因为checksum8是不能直接写到rules文件的。最后在fast.log文件中成功检测到cs---http流量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127152601875.png" referrerpolicy="no-referrer" alt="image-20250127152601875"><span> </span></p><p><span>这里的cs。rules是网上找的cs规则：</span></p><p><span>55min  cs---------https</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127162119000.png" referrerpolicy="no-referrer" alt="image-20250127162119000"></p><h4 id='webshell'><span>webshell</span></h4><p><span>1h07min  冰蝎</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127170347518.png" referrerpolicy="no-referrer" alt="image-20250127170347518"></p><p><span>哥斯拉：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127170424654.png" referrerpolicy="no-referrer" alt="image-20250127170424654"></p><h5 id='frp-2'><span>frp</span></h5><p><span>1h22min  frp   规则是针对特征写，</span></p><p><span>1、版本号对应写成正则式，version&quot;:&quot;0.xx.0&quot;</span></p><p><span>alert tcp any any -&gt; $HOME_NET any (msg:&quot;frp find&quot;; content:&quot;{</span><span>&quot;</span><span>version</span><span>&quot;</span><span>:</span><span>&quot;</span><span>&quot;; pcre:&quot;/</span><span>&quot;</span><span>version</span><span>&quot;</span><span>:</span><span>&quot;</span><span>0</span><span>.</span><span>\d{2}</span><span>.</span><span>\d{1}</span><span>&quot;</span><span>/&quot;; nocase; sid:1000042; rev:1;)</span></p><p><span>2、根据run_id 特征来写</span></p><p><span>alert tcp any any -&gt; $HOME_NET any (msg:&quot;frp find&quot;; content:&quot;{</span><span>&quot;</span><span>run_id</span><span>&quot;</span><span>:</span><span>&quot;</span><span>&quot;; nocase; sid:1000044; rev:1;)</span></p><p><span>version 后面正则表达式，表示随机的版本号，xx ，</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250128182937173.png" referrerpolicy="no-referrer" alt="image-20250128182937173"></p><h5 id='nps-2'><span>nps</span></h5><p><span>1h30min nps</span><span>	</span><span>检测不到流量包，有时候需要重启一下服务器，因为存在缓存，可能抓不到（日志中）流量，这个发送sucs和main第一次才行，所以需要重启清除缓存。特征是有几个的，但是我们这儿只写了一个特征，后面可以加几条误报的可能就比较低了。</span></p><p><span>这里是根据特征2</span><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250128183600940.png" referrerpolicy="no-referrer" alt="image-20250128183600940"></p><p><span>alert tcp any any -&gt; $HOME_NET any (msg:&quot;nps find&quot;; content:&quot;sucs&quot;; nocase; sid:1000053; rev:1;)</span></p><h1 id='232编程开发'><span>232：编程开发</span></h1><p><span>py有许多库比较方便，便于开发出工具脚本</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204201450188.png" referrerpolicy="no-referrer" alt="image-20250204201450188"></p><p><span>11min py配合微步的api接口进行测试</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204205322225.png" referrerpolicy="no-referrer" alt="image-20250204205322225"></p><p><span>放转义所以文件路径是两个\ \</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204205633430.png" referrerpolicy="no-referrer" alt="image-20250204205633430"></p><p><span>运行后会得到hash和分析的网址结果：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204210226485.png" referrerpolicy="no-referrer" alt="image-20250204210226485"></p><p><span>文件信誉报告：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204210619403.png" referrerpolicy="no-referrer" alt="image-20250204210619403"></p><p><span>30min  将这几个配合起来，写到一起：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204212756483.png" referrerpolicy="no-referrer" alt="image-20250204212756483"></p><p><span>1h    分析时候还需要写个等待的延迟，  因为你上传检测的时候是有分析过程的，但是代码调用接口是直接找结果的，然后就会没有找到结果报错，这时候就需要加个if条件让程序sleep一会。       除非你上传的文件是有历史记录的，那么就不需要分析，是直接有结果的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204224751726.png" referrerpolicy="no-referrer" alt="image-20250204224751726"></p><p><span>1h12min 将分析结果推送给wx，使用的是server酱</span><span>	</span></p><p><a href='https://sct.ftqq.com/sendkey'><span>sct.ftqq.com/sendkey</span></a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204225452106.png" referrerpolicy="no-referrer" alt="image-20250204225452106"></p><p><span>1h23min 。</span></p><p>&nbsp;</p><h1 id='233文件监控'><span>233：文件监控</span></h1><p><a href='https://cloud.tencent.com/developer/article/2384347'><span>实时监控文件系统：探索Python Watchdog库的神奇之处！-腾讯云开发者社区-腾讯云 (tencent.com)</span></a></p><p><span>7min   脚本可以监控一些文件/文件夹是否被修改、删除、创建、移动。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204231335754.png" referrerpolicy="no-referrer" alt="image-20250204231335754"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204231757001.png" referrerpolicy="no-referrer" alt="image-20250204231757001"></p><p><span>25min  配合上节的webshell检测脚本，将监控到的可疑文件直接上传检测。</span></p><p><span>先问gpt，来获取可疑文件的路径和文件名，然后</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204234800073.png" referrerpolicy="no-referrer" alt="image-20250204234800073"></p><p>&nbsp;</p><p><span>42min  修改文件，修改时候会有一个临时文件 后缀带 ~  然后需要加一个if来判断是否为临时文件，   </span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204235032957.png" referrerpolicy="no-referrer" alt="image-20250204235032957"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204235159390.png" referrerpolicy="no-referrer" alt="image-20250204235159390"></p><p>&nbsp;</p><p><span>1h  模拟</span></p><p><span>这里还可以用Py进行流量监测：</span></p><p><span>if  b  这里b是bit流，</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205153020609.png" referrerpolicy="no-referrer" alt="image-20250205153020609"></p><p>&nbsp;</p><p>&nbsp;</p><h1 id='234sigma'><span>234：sigma</span></h1><p><span>sigma 用来生成各种日志分析平台的恶意筛选语句</span></p><p>&nbsp;</p><p><span>二进制就是一些可执行程序（exe等）</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204164131392.png" referrerpolicy="no-referrer" alt="image-20250204164131392"></p><p><span>23min  安装</span></p><p><span>自带许多规则文件；</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205165817370.png" referrerpolicy="no-referrer" alt="image-20250205165817370"></p><p>&nbsp;</p><p><span>Splunk</span></p><p><span>分析日志文件的</span></p><p><span>10min  安装</span><a href='https://mp.weixin.qq.com/s/vcL7eKMYyL-TCsvmvhCI_A' target='_blank' class='url'>https://mp.weixin.qq.com/s/vcL7eKMYyL-TCsvmvhCI_A</a></p><p><span>账户splunk   密码：splunk123</span></p><p><span>打开本地8000端口登录进去，上传日志，然后通过筛选语法分析日志</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205164832056.png" referrerpolicy="no-referrer" alt="image-20250205164832056"></p><p>&nbsp;</p><p><span>36min  sigma 写规则， 运行规则生成对应平台的语句，用语句在对应平台可以进行搜索。</span></p><p><span>使用web_cve_2021.....规则文件，生成基于splunk平台在windows下的 解析生成语句：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182156710.png" referrerpolicy="no-referrer" alt="image-20250205182156710"></p><p>&nbsp;</p><p>&nbsp;</p><p><span>eg： sigma写一个在日志中查看创建用户的规则，然后运行规则生成Splunk平台的语句，生成的语句在Splunk平台进行搜索，就找出了创建用户的一些日志。</span></p><p>&nbsp;</p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182638960.png" referrerpolicy="no-referrer" alt="image-20250205182638960"></p><p><span>splunk平台：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182756170.png" referrerpolicy="no-referrer" alt="image-20250205182756170"></p><p>&nbsp;</p><p><span>43min 口令爆破的规则。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205183019111.png" referrerpolicy="no-referrer" alt="image-20250205183019111"></p><p><span>在splunk平台上执行：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205183030721.png" referrerpolicy="no-referrer" alt="image-20250205183030721"></p><h1 id='235溯源'><span>235：溯源</span></h1><p><span>就是一直查，给ip 或者样本等后，找特征，然后各种平台搜，选择合适的平台搜，社工库等。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205220917803.png" referrerpolicy="no-referrer" alt="image-20250205220917803"></p><p>&nbsp;</p><h3 id='ip反查'><span>ip反查</span></h3><p><span>26min 演示 模拟c2后门上线，找到后门外部的ip</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207120738555.png" referrerpolicy="no-referrer" alt="image-20250207120738555"></p><p><span>这里是内网ip，实战中应该是外网ip，找到后就在平台上找就行。</span></p><p><span>39min  社工库、需要付费，记得开一下小飞机。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207162128949.png" referrerpolicy="no-referrer" alt="image-20250207162128949"></p><p><span>45min  演示 ：  博客的日志，溯源攻击者。</span></p><p><span>查到了域名解析，然后看到了域名的有效期，这个也是有说法的，域名时间长的话一般就不是攻击域名，因为攻击的话是不会弄长期，容易被查。</span></p><p><span>在日志中发现有人在爆破自己服务器后台，然后就查ip。</span></p><p><span>有时候还可以反编译逆向可执行程序，找到攻击者的一些信息。</span></p><p><span>1h06min </span></p><p><span>1h13min  钓鱼邮件溯源      看原件，有ip地址，</span></p><h1 id='236反制'><span>236：反制</span></h1><p><span>蜜罐 6min  在txt中写一些目录，为一些身份信息指纹的存储路径， </span></p><p><span>14min  启动蜜罐，py2版本。开一个3306的sql服务，诱使红队连接。</span></p><p><span>蓝队人员主动打开一个3306端口，诱导红队连接：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171159978.png" referrerpolicy="no-referrer" alt="image-20250207171159978"></p><p><span>红队尝试连接后，蓝队这边就成功读取到了目标文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171324954.png" referrerpolicy="no-referrer" alt="image-20250207171324954"></p><p><span>其中.aggressor.prop是红队cs的默认存储连接过的ip信息密码。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171434641.png" referrerpolicy="no-referrer" alt="image-20250207171434641"></p><p><span>这种还有交互式的：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207172541676.png" referrerpolicy="no-referrer" alt="image-20250207172541676"></p><h4 id='伪装源码泄露'><span>伪装源码泄露：</span></h4><h5 id='calc'><span>calc</span></h5><p><span>25min  calc.exe       伪装源码泄露、让红队进行审计打开源码上钩：</span></p><p><span>蓝队配置、制作鱼饵：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208155913254.png" referrerpolicy="no-referrer" alt="image-20250208155913254"></p><p><span>然后蓝队将改好的鱼饵用脚本工具搭建起来、先将idea放到工具目录里，在打开一个web服务，带有源码泄露的一个漏洞，后台www.zip下。制作的页面实战中还是需要进行渲染：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208161258036.png" referrerpolicy="no-referrer" alt="image-20250208161258036"></p><p><span>calc.exe    不是clac，所以第一次翻车了。</span></p><p><span>红队将www.zip解压用idea打开，注意，这里只针对jer系列的产品打开，比如用记事本打开就不会执行隐藏的鱼饵，用idea打开后发现执行calc，实战不仅要将页面做好看点，也需要将源码等放进来，让其下载解压打开是源码的格式，不是像现在这个里面只有.idea文件：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208162255010.png" referrerpolicy="no-referrer" alt="image-20250208162255010"></p><h5 id='1exe'><span>1.exe</span></h5><p><span>40min--------52min 利用idea的shell script调试，做一个网站源码，里面带有后门。让红队找到网站源码，用idea打开网址源码的时候会执行我们在源码里放的后门。\</span></p><p><span>1、制作1.exe后门鱼饵，2、检查好配置 </span><span>	</span><span>3、将做好的放到工具目录下</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165458153.png" referrerpolicy="no-referrer" alt="image-20250208165458153"></p><p><span>诱导红队下载存在后门的zip，让其用idea打开进行代码审计：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165821502.png" referrerpolicy="no-referrer" alt="image-20250208165821502"></p><p><span>红队然后将下载的zip解压，用idea打开：第一次打开有警告，实战中做好后门免杀就行，</span></p><p><span>红队第二次打开就直接上线了。主要是 .idea文件，里面配置。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165937183.png" referrerpolicy="no-referrer" alt="image-20250208165937183"></p><p><span>57min  重写做一份</span></p><p>&nbsp;</p><h4 id='蚁剑-2'><span>蚁剑</span></h4><p><span>1h06min  反制蚁剑，对版本有限制。修改红队的后门代码，将红队权限反弹回来。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208184640091.png" referrerpolicy="no-referrer" alt="image-20250208184640091"></p><p><span>先用蚁剑连接上：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208191907995.png" referrerpolicy="no-referrer" alt="image-20250208191907995"></p><p><span>然后通过蓝队排查，发现了蚁剑后门文件，对其进行反制。</span></p><p><span>通过修改后门shell，让其反弹权限：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208192843191.png" referrerpolicy="no-referrer" alt="image-20250208192843191"></p><p><span>将更改后的代码替换蚁剑后门，在监听反弹端口。然后当红队在用蚁剑尝试连接时候，就会反弹shell回来：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208193129293.png" referrerpolicy="no-referrer" alt="image-20250208193129293"></p><h4 id='sqlmap'><span>sqlmap</span></h4><p><span>1h15min   鸡肋，只能用linux的sqlmap进行攻击，利用的是linux的sqlmap在注入网站时候后面如果有参数，可以执行参数命令，我们就是让这里执行我们的反弹命令。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208194101601.png" referrerpolicy="no-referrer" alt="image-20250208194101601"></p><p><span>这里先做一个提交表单的页面，诱导其对提交框进行sql注入，然后正常思路，红队对其提交数据抓包、对抓包参数进行sql注入：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195136958.png" referrerpolicy="no-referrer" alt="image-20250208195136958"></p><p><span>这里后面参数是base64加密的反弹shell命令，看着还是比较明显的，红队不会傻到看不出来，但是实战你需要多层加密，自己想办法让其变得真一点，还有这个提交表单的页面，也需要改一下（好看逼真点）：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195357290.png" referrerpolicy="no-referrer" alt="image-20250208195357290"></p><p><span>红队对提交的参数进行测试，使用的是linux的sqlmap。蓝队进行监听：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195518341.png" referrerpolicy="no-referrer" alt="image-20250208195518341"></p><p><span>1h32min goby</span></p><p><span>制作一个网页，当红队用goby扫的时候会发现漏洞：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208201045854.png" referrerpolicy="no-referrer" alt="image-20250208201045854"></p><p><span>然后用goby扫后查看结果时候一点开就会执行我们的命令：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208201335901.png" referrerpolicy="no-referrer" alt="image-20250208201335901"></p><p>&nbsp;</p><h1 id='237暴打红队'><span>237：暴打红队</span></h1><p><span>反制是溯源之后的</span></p><h4 id='反制cs'><span>反制cs</span></h4><p><span>批量上线    、条件：知道对方的CS的服务端地址，开启了http监听器</span></p><p><span>10min   批量上线  需要解密流量包中的cookie的值，找到里面的公钥信息，用一个脚本实现批量发包，让对方（红队）cs批量上线大量机器。</span></p><p><span>得不到公钥的话只能上线一个机器。</span></p><h5 id='批量上线'><span>批量上线</span></h5><p><span>欺骗防御，先用没有得到公钥的cookie进行发包，找到有cookie头的cs上线数据包：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209122851677.png" referrerpolicy="no-referrer" alt="image-20250209122851677"></p><p><span>然后用发包工具发包，其中对应头的值，发现只能上线一次，不能实现发多次包上线多次：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209123133996.png" referrerpolicy="no-referrer" alt="image-20250209123133996"></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209123252690.png" referrerpolicy="no-referrer" alt="image-20250209123252690"></p><p><span>所以需要用得到正确的公钥加密成正确的cookie进行多次发包：</span></p><p><span>解密cookie并找到公钥：1、先 找到后门地址  </span><span>	</span><span>2、下载后门文件 </span><span>	</span><span>3、解密其中的cookie</span><span>	</span><span>4、解密后的转为json格式的文件查看     这里出来的是解密后的cookie</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209130844990.png" referrerpolicy="no-referrer" alt="image-20250209130844990"></p><p><span>然后再找到cookie里面的公钥：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131048603.png" referrerpolicy="no-referrer" alt="image-20250209131048603"></p><p><span>将得到的公钥存到准备批量发包工具下的对应txt文件中，这里面其他txt文件是cs上线后的对应一些用户，计算机，进程的信息：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131229909.png" referrerpolicy="no-referrer" alt="image-20250209131229909"></p><p><span>进行批量发包10次，这里主要c2的URL不要写成后门地址，可以看到cs上线10台，这里面上线的用户，计算机，进程等信息都可以在上面的txt文件中修改。主要是公钥和cs的url。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131400336.png" referrerpolicy="no-referrer" alt="image-20250209131400336"></p><h5 id='2爆破密码'><span>2：爆破密码</span></h5><p><span>25min 条件 ： 知道对方的CS的服务端地址---------前面溯源到的。</span></p><p><span>在通过端口扫描扫出来cs的端口。然后用脚本爆破cs的密码。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209183139690.png" referrerpolicy="no-referrer" alt="image-20250209183139690"></p><h5 id='3cve'><span>3、cve </span></h5><p><span>46min  内置漏洞 ，条件：机器被CS控制的木马程序 Cobalt Strike &lt;=4.7 XSS 操作过进程管理</span></p><p><span>将两个文件放到一个网站目录下，下来就用cve脚本进行。运行后红队会上线蓝队操作的机器，只要红队查看目标进程列表，那么红队机器就会执行前面两个文件里的rce。</span></p><p><span>将程序打包成jar包，让红队弹计算器：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209190904389.png" referrerpolicy="no-referrer" alt="image-20250209190904389"></p><p>&nbsp;</p><p><span>这里用脚本进行上线：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191239995.png" referrerpolicy="no-referrer" alt="image-20250209191239995"></p><p><span>然后只要一点击进程列表，那么红队的权限就反弹回来，这里是弹的计算器：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191047069.png" referrerpolicy="no-referrer" alt="image-20250209191047069"></p><h5 id='4旁站反制'><span>4、旁站反制</span></h5><p><span>55min </span><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191553847.png" referrerpolicy="no-referrer" alt="image-20250209191553847"></p><p><span>就是你找到了c2服务器的ip，还可以在其服务器上发现有没有其他的服务，比如一般来说会配合着nps这种内网工具，那么我们可以打nps达到反制红队：</span></p><p><span>这里演示是随便找一个nps服务：1、登录页面抓包 </span><span>	</span><span>2、使用bp自带插件直接进入nps</span><span>	</span><span>3、放包刷新直接进去</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209192831804.png" referrerpolicy="no-referrer" alt="image-20250209192831804"></p><p><span>钓鱼：</span></p><p><span>1h05min </span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209193003314.png" referrerpolicy="no-referrer" alt="image-20250209193003314"></p><h1 id='238报告书写简历'><span>238：报告书写（简历）</span></h1><h4 id='风险报告'><span>风险报告</span></h4><p><span>1min  py脚本生成风险报告模板。漏洞风险报告</span><span>	</span><span>ReportGenX.py</span></p><h4 id='渗透报告'><span>渗透报告</span></h4><p><span>5min 渗透报告生成。docker搭建的平台。不过这里用kali搭建的好像有点卡，后期可以专门弄个大的内存搭建。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210001249145.png" referrerpolicy="no-referrer" alt="image-20250210001249145"></p><p><span>模板跟着写就行，没什么技术含量：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210001611567.png" referrerpolicy="no-referrer" alt="image-20250210001611567"></p><p>&nbsp;</p><p><span>10min 蓝队值守报告        小翻车，在25min评论区解决----------没解决LazyAnFuZai.jar</span></p><p><a href='https://github.com/R4gd0ll/LazyAnFuZai' target='_blank' class='url'>https://github.com/R4gd0ll/LazyAnFuZai</a></p><p><span>17min  简历模板</span></p><p><span>19min  靶场 ------玄机 </span></p><h2 id='云函数'><span>云函数</span></h2><p><a href='https://xz.aliyun.com/t/11625' target='_blank' class='url'>https://xz.aliyun.com/t/11625</a></p><p><a href='https://mp.weixin.qq.com/s/Js6i71wYTGoeM1sG8H8D6g' target='_blank' class='url'>https://mp.weixin.qq.com/s/Js6i71wYTGoeM1sG8H8D6g</a></p><p><a href='https://mp.weixin.qq.com/s/CI_C7zrH5vfzPs1XQiRqug' target='_blank' class='url'>https://mp.weixin.qq.com/s/CI_C7zrH5vfzPs1XQiRqug</a><span>  ---靠运气可以查到其appid 最后可以查到个人ip信息。</span></p><p><a href='https://cloud.tencent.com/developer/article/2437292' target='_blank' class='url'>https://cloud.tencent.com/developer/article/2437292</a></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210002412990.png" referrerpolicy="no-referrer" alt="image-20250210002412990"></p><p><span>45min  演示项目ddos  反制云函数。</span></p><p><span>消耗云函数资源，占用资源：使用工具对其资源进行ddos。</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210003120662.png" referrerpolicy="no-referrer" alt="image-20250210003120662"></p><p><span>可以看到，还是有点用的，占用了一定的资源：</span></p><p><img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210003208638.png" referrerpolicy="no-referrer" alt="image-20250210003208638"></p></div></div>
</body>
</html>